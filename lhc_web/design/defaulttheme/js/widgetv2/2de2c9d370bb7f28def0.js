"use strict";(self.webpackChunkLiveHelperChat=self.webpackChunkLiveHelperChat||[]).push([[417],{9417:function(e,t,n){n.r(t),n.d(t,{nodeJSChat:function(){return p}});var r=n(5861),a=n(5671),s=n(3144),c=n(6296),i=n(7757),u=n.n(i),o=n(2137),h=function(){function e(){(0,a.Z)(this,e),this.params={},this.attributes=null,this.chatEvents=null}var t;return(0,s.Z)(e,[{key:"setParams",value:(t=(0,r.Z)(u().mark((function e(t,a,s){var i,h,p,l,v,f,k,x,b,m,_,d,w,g,C;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C=function(){return(C=(0,r.Z)(u().mark((function e(){var t,n,r,s,o,h,p;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null==k,k=l.subscribe("uo_"+i),1!=t){e.next=36;break}e.prev=3,n=!1,r=!1,e.prev=6,o=(0,c.Z)(k);case 8:return e.next=10,o.next();case 10:if(!(n=!(h=e.sent).done)){e.next=16;break}"check_message"==(p=h.value).op?a.eventEmitter.emitEvent("checkMessageOperator"):"is_online"==p.op&&l.transmitPublish("ous_"+f,{op:"vi_online",status:!0,vid:i});case 13:n=!1,e.next=8;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(6),r=!0,s=e.t0;case 22:if(e.prev=22,e.prev=23,!n||null==o.return){e.next=27;break}return e.next=27,o.return();case 27:if(e.prev=27,!r){e.next=30;break}throw s;case 30:return e.finish(27);case 31:return e.finish(22);case 32:e.next=36;break;case 34:e.prev=34,e.t1=e.catch(3);case 36:case"end":return e.stop()}}),e,null,[[3,34],[6,18,22,32],[23,,27,31]])})))).apply(this,arguments)},g=function(){return C.apply(this,arguments)},w=function(){o.a.makeRequest(a.LHC_API.args.lhc_base_url+a.lang+"nodejshelper/tokenvisitor",{params:{ts:(new Date).getTime()}},function(){var e=(0,r.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f=t.instance_id,e.next=3,Promise.all([l.invoke("login",{hash:t.hash,chanelName:v,instance_id:t.instance_id}),l.listener("authenticate").once()]);case 3:g();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},this.params=t,this.attributes=a,this.chatEvents=s,i=this.attributes.userSession.getVID(),h={protocolVersion:1,hostname:t.hostname,path:t.path,authTokenName:"socketCluster.authToken_vi"},""!=t.port&&(h.port=parseInt(t.port)),1==t.secure&&(h.secure=!0),p=n(3502),l=p.create(h),v="uo_"+i,f=this.attributes.instance_id,k=null,e.next=17,l.listener("connect").once();case 17:e.sent.isAuthenticated?(g(),a.LHC_API.args.check_messages=!1):w(),e.prev=19,x=!1,b=!1,e.prev=22,_=(0,c.Z)(l.listener("deauthenticate"));case 24:return e.next=26,_.next();case 26:if(!(x=!(d=e.sent).done)){e.next=32;break}d.value,w();case 29:x=!1,e.next=24;break;case 32:e.next=38;break;case 34:e.prev=34,e.t0=e.catch(22),b=!0,m=e.t0;case 38:if(e.prev=38,e.prev=39,!x||null==_.return){e.next=43;break}return e.next=43,_.return();case 43:if(e.prev=43,!b){e.next=46;break}throw m;case 46:return e.finish(43);case 47:return e.finish(38);case 48:e.next=52;break;case 50:e.prev=50,e.t1=e.catch(19);case 52:case"end":return e.stop()}}),e,this,[[19,50],[22,34,38,48],[39,,43,47]])}))),function(e,n,r){return t.apply(this,arguments)})}]),e}(),p=new h}}]);
//# sourceMappingURL=2de2c9d370bb7f28def0.js.map