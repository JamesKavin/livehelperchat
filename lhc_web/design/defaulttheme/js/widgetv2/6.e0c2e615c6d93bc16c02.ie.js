(window.webpackJsonpLHCReactAPP=window.webpackJsonpLHCReactAPP||[]).push([[6],{481:function(t,e,a){"use strict";a.r(e),a.d(e,"nodeJSChat",(function(){return d}));var n=a(5),i=a.n(n),s=a(6),c=a.n(s),h=a(3),o=a(11),d=new(function(){function t(){var e=this;i()(this,t),this.socket=null,h.a.eventEmitter.addListener("endedChat",(function(){null!==e.socket&&e.socket.destroy()}))}return c()(t,[{key:"bootstrap",value:function(t,e,n){var i,s=n(),c=s.chatwidget.getIn(["chatData","id"]),d=(s.chatwidget.getIn(["chatData","hash"]),s.chatwidget.getIn(["chat_ui","sync_interval"])),r={hostname:t.hostname,path:t.path};""!=t.port&&(r.port=parseInt(t.port)),1==t.secure&&(r.secure=!0),i=t.instance_id>0?"chat_"+t.instance_id+"_"+c:"chat_"+c;var g=a(490),_=this.socket=g.connect(r),p=null;function u(e){1==e.status?t.instance_id>0?_.publish("chat_"+t.instance_id+"_"+c,{op:"vt",msg:e.msg}):_.publish("chat_"+c,{op:"vt",msg:e.msg}):t.instance_id>0?_.publish("chat_"+t.instance_id+"_"+c,{op:"vts"}):_.publish("chat_"+c,{op:"vts"})}function l(e){t.instance_id>0?_.publish("chat_"+t.instance_id+"_"+c,{op:"vt",msg:"✉️ "+e.msg}):_.publish("chat_"+c,{op:"vt",msg:"✉️ "+e.msg})}function m(e){t.instance_id>0?_.publish("chat_"+t.instance_id+"_"+c,{op:"vt",msg:"📕️ error happened while sending visitor message, please inform your administrator!"}):_.publish("chat_"+c,{op:"vt",msg:"📕️ error happened while sending visitor message, please inform your administrator!"})}function v(){(p=t.instance_id>0?_.subscribe("chat_"+t.instance_id+"_"+c):_.subscribe("chat_"+c)).on("subscribeFail",(function(t){console.error("Failed to subscribe to the sample channel due to error: "+t)})),p.on("subscribe",(function(){_.publish(t.instance_id>0?"chat_"+t.instance_id+"_"+c:"chat_"+c,{op:"vi_online",status:!0})})),p.watch((function(a){if("ot"==a.op)1==a.data.status?e({type:"chat_status_changed",data:{text:a.data.ttx}}):e({type:"chat_status_changed",data:{text:""}});else if("cmsg"==a.op||"schange"==a.op){var i=n();i.chatwidget.hasIn(["chatData","id"])&&e(Object(o.d)({chat_id:i.chatwidget.getIn(["chatData","id"]),hash:i.chatwidget.getIn(["chatData","hash"]),lmgsid:i.chatwidget.getIn(["chatLiveData","lmsgid"]),theme:i.chatwidget.get("theme")}))}else if("schange"==a.op){var s=n();s.chatwidget.hasIn(["chatData","id"])&&e(Object(o.b)({chat_id:s.chatwidget.getIn(["chatData","id"]),hash:s.chatwidget.getIn(["chatData","hash"]),mode:s.chatwidget.get("mode"),theme:s.chatwidget.get("theme")}))}else if("vo"==a.op){var c=n();c.chatwidget.hasIn(["chatData","id"])&&_.publish(t.instance_id>0?"chat_"+t.instance_id+"_"+c.chatwidget.getIn(["chatData","id"]):"chat_"+c.chatwidget.getIn(["chatData","id"]),{op:"vi_online",status:!0})}})),h.a.eventEmitter.addListener("visitorTyping",u),h.a.eventEmitter.addListener("messageSend",l),h.a.eventEmitter.addListener("messageSendError",m),e({type:"CHAT_UI_UPDATE",data:{sync_interval:1e4}}),e({type:"CHAT_ADD_OVERRIDE",data:"typing"})}_.on("error",(function(t){console.error(t)})),_.on("close",(function(){null!==p&&p.destroy(),h.a.eventEmitter.removeListener("visitorTyping",u),h.a.eventEmitter.removeListener("messageSend",l),h.a.eventEmitter.removeListener("messageSendError",m),e({type:"CHAT_UI_UPDATE",data:{sync_interval:d}}),e({type:"CHAT_REMOVE_OVERRIDE",data:"typing"})})),_.on("connect",(function(e){e.isAuthenticated&&c>0?v():_.emit("login",{hash:t.hash,chanelName:i},(function(t){t?console.log(t):v()}))}))}}]),t}())}}]);
//# sourceMappingURL=6.e0c2e615c6d93bc16c02.ie.js.map