{"version":3,"file":"307.40312c53f609f1919d8b.js","mappings":"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","sources":["webpack://LHCReactAPP/./src/components/InlineIframe.js"],"sourcesContent":["import React, { Component } from 'react';\nimport { connect } from \"react-redux\";\nimport { updateMessageData } from \"../actions/chatActions\";\n\n@connect((store) => {\n    return {\n        chatwidget: store.chatwidget\n    };\n})\n\nclass InlineIframe extends Component {\n\n    constructor(props) {\n        super(props);\n    }\n\n    getDocument(a) {\n        return a.contentWindow ? a.contentWindow.document : a.contentDocument ? a.contentDocument : a.document ? a.document : null\n    }\n\n    insertCssRemoteFile(elmDomDoc, attr) {\n\n        var elm = null;\n\n        if (attr.id && attr.href && (elm = elmDomDoc.getElementById(attr.id)) !== null) {\n            elm.href = attr.href\n            return;\n        }\n\n        var d = elmDomDoc.getElementsByTagName(\"head\")[0],\n            k = elmDomDoc.createDocumentFragment(),\n            e = elmDomDoc.createElement('link');\n\n        e.rel = \"stylesheet\";\n        e.crossOrigin = \"*\";\n\n        for (var b in attr) e[b] = attr[b];\n\n        k.appendChild(e);\n        d.appendChild(k);\n    }\n\n    insertJSFile(elmDomDoc, src, async, attr) {\n        var d = elmDomDoc.getElementsByTagName(\"head\")[0],\n            k = elmDomDoc.createDocumentFragment(),\n            e = elmDomDoc.createElement('script');\n\n        e.type = 'text/javascript';\n        if (typeof async === 'undefined' || async === true) {\n            e.async = true;\n        }\n\n        e.crossOrigin = \"*\";\n        e.src = src;\n\n        if (attr) {\n            delete attr['src'];\n            if (typeof attr['async'] !== 'undefined') {\n                delete attr['async'];\n            }\n            Object.keys(attr).forEach(key => {\n                e.setAttribute(key,attr[key]);\n            })\n        }\n\n        k.appendChild(e);\n        d.appendChild(k);\n    }\n\n    prepareIframe(iframe) {\n        let documentFrame = this.getDocument(iframe);\n\n        documentFrame.getElementsByTagName(\"head\")[0].innerHTML = '<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /><meta name=\"viewport\" content=\"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no\" />';\n\n        var html = documentFrame.getElementsByTagName(\"html\")[0];\n        html.setAttribute(\"lang\", 'en');\n        html.setAttribute(\"dir\", 'ltr');\n\n        var nodeDoctype = document.implementation.createDocumentType(\n            'html',\n            '',\n            ''\n        );\n\n        if (documentFrame.doctype) {\n            documentFrame.replaceChild(nodeDoctype, documentFrame.doctype);\n        } else {\n            documentFrame.insertBefore(nodeDoctype, documentFrame.childNodes[0]);\n        }\n\n        if (this.props['data-css']) {\n            JSON.parse(this.props['data-css']).forEach((item) => {\n                this.insertCssRemoteFile(documentFrame, item);\n            });\n        }\n\n        if (this.props['data-js']) {\n            JSON.parse(this.props['data-js']).forEach((item) => {\n                this.insertJSFile(documentFrame, item['src'], (item['async'] ? item['async'] : false), item);\n            });\n        }\n\n        documentFrame.body.innerHTML = this.props['data-body'];\n\n        return documentFrame;\n    }\n\n    prependURL() {\n\n        var js_args = [];\n\n        var paramsReturn = '?';\n        var jsVars = this.props.chatwidget.get('jsVars');\n\n        Object.keys(jsVars).forEach(key => {\n            js_args.push('jsvar[' + key + ']=' + encodeURIComponent(jsVars[key]));\n        })\n\n        if (js_args.length > 0) {\n            paramsReturn = paramsReturn + '&' + js_args.join('&');\n        }\n\n        if (this.props.chatwidget.hasIn(['chatData','id'])) {\n            paramsReturn = paramsReturn + '&chat_id=' + this.props.chatwidget.getIn(['chatData','id']) + '&hash=' + this.props.chatwidget.getIn(['chatData','hash']) + '&msg_id=' + this.props['data-id'];\n        }\n\n        return paramsReturn;\n    }\n\n    componentDidMount() {\n        const iframe = document.createElement(\"iframe\");\n\n        if (this.props['data-form']) {\n            iframe.src = this.props['data-form'] + this.prependURL();\n        }\n\n        iframe.onload = () => {\n\n            if (!this.props['data-form']) {\n                let documentFrame = this.prepareIframe(iframe);\n\n                var closeActions = documentFrame.body.getElementsByClassName('lhc-iframe-close');\n\n                for (let i = 0; i < closeActions.length; i++) {\n                    closeActions[i].addEventListener('click',() => {\n                        updateMessageData({\n                            'id' : this.props.chatwidget.getIn(['chatData','id']),\n                            'hash' : this.props.chatwidget.getIn(['chatData','hash']),\n                            'msg_id' : this.props['data-id']\n                        }, {'action' : 'iframe_close'}).then(() => {\n                            this.props.updateMessage(this.props['data-id']);\n                        });\n                    });\n                }\n            }\n\n            let elmScroll = document.getElementById('messages-scroll');\n            if (elmScroll !== null) {\n                elmScroll.scrollTop = elmScroll.scrollHeight + 1000;\n            }\n\n            if (!this.props['data-form'] && this.props['data-js-body']) {\n                let js = documentFrame.createElement(\"script\");\n                js.textContent = this.props['data-js-body'];\n                documentFrame.head.appendChild(js);\n            }\n        };\n\n        iframe.onerror = function() {\n            console.log(\"Something wrong happened\");\n        };\n\n        if (this.props['data-style']) {\n            iframe.style = this.props['data-style'];\n        }\n\n        if (this.props['data-iframe']) {\n            let iframeOptions = JSON.parse(this.props['data-iframe']);\n\n            // Remove any previous instances of same iframe if it's shown again\n            if (iframeOptions['one_per_chat'] && iframeOptions['one_per_chat'] == true && iframeOptions['iframe-identifier']) {\n                let sameIframes = document.getElementsByClassName(iframeOptions['iframe-identifier']);\n                for (let i = 0; i < sameIframes.length; i++) {\n                    if (sameIframes[i].parentNode) {\n                        updateMessageData({\n                            'id' : this.props.chatwidget.getIn(['chatData','id']),\n                            'hash' : this.props.chatwidget.getIn(['chatData','hash']),\n                            'msg_id' : sameIframes[i].getAttribute('data-msg-id')\n                        }, {'action' : 'iframe_close'}).then(() => {\n                            this.props.updateMessage(sameIframes[i].getAttribute('data-msg-id'));\n                            //sameIframes[i].parentNode.removeChild(sameIframes[i]); // Not needed anymore becase default flow handles all taht\n                        });\n                    }\n                }\n            }\n\n            if (iframeOptions['iframe-identifier']) {\n                iframe.className = iframeOptions['iframe-identifier']; // Will be used to allow only one instance to be mounted\n            }\n\n            iframe.setAttribute('data-msg-id',this.props['data-id']);\n        }\n\n        document.getElementById(\"iframe-msg-\"+this.props['data-id']).appendChild(iframe);\n    }\n\n\n    render() {\n\n        const { t } = this.props;\n\n        return (\n            <div id={\"iframe-msg-\"+this.props['data-id']}></div>\n        );\n    }\n}\n\nexport default InlineIframe;"],"names":["InlineIframe","connect","store","chatwidget","props","a","contentWindow","document","contentDocument","elmDomDoc","attr","elm","id","href","getElementById","d","getElementsByTagName","k","createDocumentFragment","e","createElement","b","rel","crossOrigin","appendChild","src","async","type","Object","keys","forEach","key","setAttribute","iframe","documentFrame","this","getDocument","innerHTML","html","nodeDoctype","implementation","createDocumentType","doctype","replaceChild","insertBefore","childNodes","JSON","parse","item","insertCssRemoteFile","insertJSFile","body","js_args","paramsReturn","jsVars","get","push","encodeURIComponent","length","join","hasIn","getIn","prependURL","onload","closeActions","prepareIframe","getElementsByClassName","i","addEventListener","updateMessageData","then","updateMessage","elmScroll","scrollTop","scrollHeight","js","textContent","head","onerror","console","log","style","iframeOptions","sameIframes","parentNode","getAttribute","className","t","Component"],"sourceRoot":""}