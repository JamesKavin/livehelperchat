"use strict";(self.webpackChunkLiveHelperChat=self.webpackChunkLiveHelperChat||[]).push([[417],{9417:function(e,t,n){n.r(t),n.d(t,{nodeJSChat:function(){return p}});var r=n(5861),s=n(5671),a=n(3144),i=n(6296),c=n(7757),u=n.n(c),o=n(2137),h=function(){function e(){(0,s.Z)(this,e),this.params={},this.attributes=null,this.chatEvents=null}var t;return(0,a.Z)(e,[{key:"setParams",value:(t=(0,r.Z)(u().mark((function e(t,s,a){var c,h,p,l,f,v,k,x,b,m,_,d,w,g,C;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return C=function(){return(C=(0,r.Z)(u().mark((function e(){var t,n,r,a,o,h,p;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=null==k,k=l.subscribe("uo_"+c),1!=t){e.next=31;break}n=!1,r=!1,e.prev=5,o=(0,i.Z)(k);case 7:return e.next=9,o.next();case 9:if(!(n=!(h=e.sent).done)){e.next=15;break}"check_message"==(p=h.value).op?s.eventEmitter.emitEvent("checkMessageOperator"):"is_online"==p.op&&l.transmitPublish("ous_"+v,{op:"vi_online",status:!0,vid:c});case 12:n=!1,e.next=7;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(5),r=!0,a=e.t0;case 21:if(e.prev=21,e.prev=22,!n||null==o.return){e.next=26;break}return e.next=26,o.return();case 26:if(e.prev=26,!r){e.next=29;break}throw a;case 29:return e.finish(26);case 30:return e.finish(21);case 31:case"end":return e.stop()}}),e,null,[[5,17,21,31],[22,,26,30]])})))).apply(this,arguments)},g=function(){return C.apply(this,arguments)},w=function(){o.a.makeRequest(s.LHC_API.args.lhc_base_url+s.lang+"nodejshelper/tokenvisitor",{params:{ts:(new Date).getTime()}},function(){var e=(0,r.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return v=t.instance_id,e.next=3,Promise.all([l.invoke("login",{hash:t.hash,chanelName:f,instance_id:t.instance_id}),l.listener("authenticate").once()]);case 3:g();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},this.params=t,this.attributes=s,this.chatEvents=a,c=this.attributes.userSession.getVID(),h={protocolVersion:1,hostname:t.hostname,path:t.path,authTokenName:"socketCluster.authToken_vi"},""!=t.port&&(h.port=parseInt(t.port)),1==t.secure&&(h.secure=!0),p=n(2984),l=p.create(h),f="uo_"+c,v=this.attributes.instance_id,k=null,e.next=17,l.listener("connect").once();case 17:e.sent.isAuthenticated?(g(),s.LHC_API.args.check_messages=!1):w(),x=!1,b=!1,e.prev=21,_=(0,i.Z)(l.listener("deauthenticate"));case 23:return e.next=25,_.next();case 25:if(!(x=!(d=e.sent).done)){e.next=31;break}d.value,w();case 28:x=!1,e.next=23;break;case 31:e.next=37;break;case 33:e.prev=33,e.t0=e.catch(21),b=!0,m=e.t0;case 37:if(e.prev=37,e.prev=38,!x||null==_.return){e.next=42;break}return e.next=42,_.return();case 42:if(e.prev=42,!b){e.next=45;break}throw m;case 45:return e.finish(42);case 46:return e.finish(37);case 47:case"end":return e.stop()}}),e,this,[[21,33,37,47],[38,,42,46]])}))),function(e,n,r){return t.apply(this,arguments)})}]),e}(),p=new h}}]);
//# sourceMappingURL=02f467d7edf228ac3e36.js.map