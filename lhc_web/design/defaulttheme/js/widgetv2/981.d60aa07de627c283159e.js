(self.webpackChunkLHCReactAPP=self.webpackChunkLHCReactAPP||[]).push([[981],{2858:function(t){t.exports=function(t){if(Array.isArray(t))return t}},3884:function(t){t.exports=function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var a=[],s=!0,i=!1,n=void 0;try{for(var o,r=t[Symbol.iterator]();!(s=(o=r.next()).done)&&(a.push(o.value),!e||a.length!==e);s=!0);}catch(t){i=!0,n=t}finally{try{s||null==r.return||r.return()}finally{if(i)throw n}}return a}}},521:function(t){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}},3038:function(t,e,a){var s=a(2858),i=a(3884),n=a(521);t.exports=function(t,e){return s(t)||i(t,e)||n()}},6313:function(t,e,a){"use strict";var s=a(4575),i=a.n(s),n=a(3913),o=a.n(n),r=a(2205),c=a.n(r),h=a(8585),l=a.n(h),d=a(9754),p=a.n(d),u=a(7294);var g=function(t){c()(n,t);var e,a,s=(e=n,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,s=p()(e);if(a){var i=p()(this).constructor;t=Reflect.construct(s,arguments,i)}else t=s.apply(this,arguments);return l()(this,t)});function n(t){return i()(this,n),s.call(this,t)}return o()(n,[{key:"render",value:function(){return u.createElement(u.Fragment,null,u.createElement("div",{className:"fade modal-backdrop show"}),u.createElement("div",{role:"dialog",id:"dialog-content","aria-modal":"true",className:"fade modal show d-block p-2",tabIndex:"-1"},u.createElement("div",{className:"modal-content p-2"},u.createElement("p",null,this.props.text),u.createElement("div",{className:"modal-footer"},u.createElement("button",{className:"btn btn-secondary btn-sm",onClick:this.props.close,type:"button"},this.props.closeText)))))}}]),n}(u.PureComponent);e.Z=g},2446:function(t,e,a){"use strict";var s=a(7154),i=a.n(s),n=a(4575),o=a.n(n),r=a(3913),c=a.n(r),h=a(1506),l=a.n(h),d=a(2205),p=a.n(d),u=a(8585),g=a.n(u),m=a(9754),f=a.n(m),v=a(9713),w=a.n(v),y=a(7294),b=a(9669),S=a.n(b),I=a(488),k=a.n(I),_=a(7139),E=a(298),C=a.n(E);var D=function(t){p()(r,t);var e,s,n=(e=r,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,a=f()(e);if(s){var i=f()(this).constructor;t=Reflect.construct(a,arguments,i)}else t=a.apply(this,arguments);return g()(this,t)});function r(t){var e;return o()(this,r),e=n.call(this,t),w()(l()(e),"state",{body:null}),w()(l()(e),"dismissModal",(function(){e.props.toggle()})),w()(l()(e),"generalOnClick",(function(t){var a=e.props.t,s=t["data-bb-code"];if(t["data-promt"]&&"img"==t["data-promt"])(i=prompt(a("bbcode.img_link")))&&(s="["+s+"]"+i+"[/"+s+"]");else if(t["data-promt"]&&"url"==t["data-promt"]){var i;(i=prompt(a("bbcode.link")))&&(s="[url="+i+"]"+a("bbcode.link_here")+"[/url]")}e.props.insertText(s),e.props.toggle()})),w()(l()(e),"generalDataActionClick",(function(t){t["data-action"]&&e.props[t["data-action"]]&&e.props[t["data-action"]]()})),e}return c()(r,[{key:"componentDidMount",value:function(){var t=this;S().get(window.lhcChat.base_url+this.props.dataUrl).then((function(e){t.setState({body:e.data});var s=document.getElementById("dialog-content"),i=a(9539),n=s.querySelectorAll('[data-toggle="tab"]');if(n.length>0){var o=0;Array.prototype.forEach.call(n,(function(t){new i.Tab(t)}));var r=new(C())(".tab-content");r.onSwipeLeft((function(){o=o<n.length-1?o+1:0,n[o].Tab.show()})),r.onSwipeRight((function(){o=o>0?o-1:n.length-1,n[o].Tab.show()}))}})).catch((function(t){console.log(t)}))}},{key:"render",value:function(){var t=this;return y.createElement(y.Fragment,null,null!==this.state.body&&y.createElement("div",{className:"fade modal-backdrop show"}),null!==this.state.body&&y.createElement("div",{role:"dialog",id:"dialog-content","aria-modal":"true",className:"fade modal show d-block",tabIndex:"-1"},k()(this.state.body,{replace:function(e){if(e.attribs&&"react-close-modal"===e.attribs.id)return y.createElement("button",{type:"button",className:"close float-right","data-dismiss":"modal",onClick:t.dismissModal,"aria-label":"Close"},y.createElement("span",{"aria-hidden":"true"},"×"));if(e.attribs&&e.attribs.bbitem)return e.attribs.class&&(e.attribs.className=e.attribs.class,delete e.attribs.class),y.createElement("a",i()({},e.attribs,{onClick:function(a){return t.generalOnClick(e.attribs)}}),(0,I.domToReact)(e.children));if(e.type&&"tag"===e.type&&e.name&&"input"==e.name&&e.attribs&&e.attribs.type&&"button"==e.attribs.type)return e.attribs.class&&(e.attribs.className=e.attribs.class,delete e.attribs.class),y.createElement("input",i()({},e.attribs,{onClick:function(a){return t.generalDataActionClick(e.attribs)}}));if(e.type&&"script"===e.type){if(e.children.length>0)setTimeout((function(){var t=document.createElement("script");t.appendChild(document.createTextNode(e.children[0].data)),document.getElementsByTagName("head").item(0).appendChild(t)}),500);else if(e.attribs&&e.attribs.src){var a=document.createElement("script");a.src=e.attribs.src,a.type="text/javascript",document.getElementsByTagName("head").item(0).appendChild(a)}return y.createElement(y.Fragment,null)}}})))}}]),r}(y.PureComponent);e.Z=(0,_.Z)()(D)},2981:function(t,e,a){"use strict";a.r(e),a.d(e,{default:function(){return et}});var s=a(4575),i=a.n(s),n=a(3913),o=a.n(n),r=a(1506),c=a.n(r),h=a(2205),l=a.n(h),d=a(8585),p=a.n(d),u=a(9754),g=a.n(u),m=a(9713),f=a.n(m),v=a(7294),w=a(6458),y=a(488),b=a.n(y),S=a(6512),I=a(9944),k=a(7154),_=a.n(k),E=a(3038),C=a.n(E),D=a(7139),L=a(2137);var x=function(t){l()(n,t);var e,a,s=(e=n,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,s=g()(e);if(a){var i=g()(this).constructor;t=Reflect.construct(s,arguments,i)}else t=s.apply(this,arguments);return p()(this,t)});function n(t){var e;return i()(this,n),e=s.call(this,t),f()(c()(e),"state",{jsExecuted:!1}),e.abstractClick=e.abstractClick.bind(c()(e)),e.imageLoaded=e.imageLoaded.bind(c()(e)),e.updateTriggerClicked=e.updateTriggerClicked.bind(c()(e)),e.disableEditor=!1,e.delayData=[],e}return o()(n,[{key:"addLoader",value:function(t,e){t["data-no-change"]||"button"!=t.type||(e.setAttribute("disabled","disabled"),e.innerHTML='<i class="material-icons lhc-spin">&#xf113;</i>'+e.innerHTML)}},{key:"abstractClick",value:function(t,e){var a=this,s=this.props.t;if(void 0===t.onchange){if(this.addLoader(t,e.target),t.onclick)if(-1!==t.onclick.indexOf("lhinst.updateTriggerClicked"))this.updateTriggerClicked({type:"/(type)/triggerclicked"},t,e.target);else if(-1!==t.onclick.indexOf("notificationsLHC.sendNotification"))this.props.dispatch((0,S.rN)()),e.target.innerHTML=s("notifications.subscribing"),setTimeout((function(){a.removeMetaMessage(t["data-id"])}),500);else if(-1!==t.onclick.indexOf("lhinst.buttonClicked"))this.updateTriggerClicked({type:""},t,e.target);else if(-1!==t.onclick.indexOf("lhinst.startVoiceCall"))this.props.voiceCall();else if(-1!==t.onclick.indexOf("lhinst.chooseFile"))this.props.abstractAction("fileupload");else if(-1!==t.onclick.indexOf("lhinst.updateChatClicked"))this.updateTriggerClicked({type:"",mainType:"updatebuttonclicked"},t,e.target);else if(-1!==t.onclick.indexOf("lhinst.editGenericStep"))this.updateTriggerClicked({type:"/(type)/editgenericstep"},t,e.target);else if(-1!==t.onclick.indexOf("lhinst.hideShowAction")){var i=JSON.parse(t["data-load"]),n=document.getElementById("message-more-"+i.id);n.classList.contains("hide")?(e.target.innerText=i.hide_text,n.classList.remove("hide")):(e.target.innerText=i.show_text,n.classList.add("hide"))}else if(-1!==t.onclick.indexOf("lhinst.executeJS"))(0,S.bQ)(t,this);else if(-1!==t.onclick.indexOf("lhinst.dropdownClicked")){var o=document.getElementById("id_generic_list-"+t["data-id"]);o&&"0"!=o.value&&""!=o.value?(t["data-payload"]=o.value,this.updateTriggerClicked({type:"/(type)/valueclicked"},t,e.target)):alert(s("bot.please_choose"))}else L.a.emitEvent("MessageClick",[t,this.props.dispatch]),console.log("Unknown click event: "+t.onclick);e.preventDefault()}else{if(t.type&&"checkbox"==t.type){if("enable-confirm"==t["payload-type"]){var r=document.getElementById("confirm-button-"+t["data-id"]);e.target.checked?(r.removeAttribute("disabled"),r.onclick=function(e){return a.updateTriggerClicked({type:""},{"data-payload":"confirm","data-id":t["data-id"]},e.target)}):r.setAttribute("disabled","disabled")}return}var c=e.target.options[e.target.selectedIndex],h={"data-payload":c.getAttribute("data-payload"),"data-id":c.getAttribute("data-id")};"trigger"==c.getAttribute("payload-type")?this.updateTriggerClicked({type:"/(type)/triggerclicked"},h,e.target):"button"!=c.getAttribute("payload-type")&&"payload"!=c.getAttribute("payload-type")||this.updateTriggerClicked({type:""},h,e.target)}}},{key:"removeMetaMessage",value:function(t){setTimeout((function(){var e=document.getElementById("msg-"+t);if(e){var a,s=e.getElementsByClassName("meta-message-"+t);for(a=0;a<s.length;a++)s[a].parentNode.removeChild(s[a])}}),500)}},{key:"updateTriggerClicked",value:function(t,e,a){var s=this;this.props.dispatch((0,S.FG)(t,{payload:e["data-payload"],id:e["data-id"],processed:void 0===e["data-keep"]})).then((function(t){e["data-keep"]||s.removeMetaMessage(e["data-id"]),t.data.t&&L.a.sendMessageParent("botTrigger",[{trigger:t.data.t}]),s.props.updateMessages(),s.props.updateStatus()}))}},{key:"imageLoaded",value:function(t){this.props.scrollBottom&&this.props.scrollBottom(!0,!0)}},{key:"componentDidMount",value:function(){var t=this;this.props.setMetaUpdateState(-1!==this.props.msg.msg.indexOf("meta-auto-hide")),1==this.disableEditor?this.props.setEditorEnabled(!1):this.props.setEditorEnabled(!0),this.delayData.length>0&&this.delayData.forEach((function(e){t.props.sendDelay(e)}))}},{key:"formatStringToCamelCase",value:function(t){var e=t.split("-");return 1===e.length?e[0]:e[0]+e.slice(1).map((function(t){return t[0].toUpperCase()+t.slice(1)})).join("")}},{key:"getStyleObjectFromString",value:function(t){var e=this,a={};return t.split(";").forEach((function(t){var s=t.split(":"),i=C()(s,2),n=i[0],o=i[1];if(n){var r=e.formatStringToCamelCase(n.trim());a[r]=o.trim()}})),a}},{key:"render",value:function(){var t=this,e=(this.props.t,!1),a=b()(this.props.msg.msg,{replace:function(a){if(a.attribs){var s=Object.assign({},a.attribs);if(a.attribs.class){if(a.attribs.className=a.attribs.class,-1!==a.attribs.className.indexOf("message-row")&&t.props.id>0)a.attribs.className+=" fade-in-fast",t.props.msg.msop>0&&t.props.msg.msop!=t.props.msg.lmsop&&0==e&&(a.attribs.className+=" operator-changes",e=!0);else if(t.props.profilePic&&-1!==a.attribs.className.indexOf("vis-icon-hld"))return v.createElement("img",{className:"profile-msg-pic",onLoad:t.imageLoaded,src:t.props.profilePic,alt:"",title:""});delete a.attribs.class}if(a.attribs.onclick&&delete a.attribs.onclick,a.name&&"img"===a.name)return a.attribs.style&&(a.attribs.style=t.getStyleObjectFromString(a.attribs.style)),v.createElement("img",_()({},a.attribs,{onLoad:t.imageLoaded,onClick:function(e){return t.abstractClick(s,e)}}));if(a.name&&"button"===a.name){if(s.onclick)return a.attribs.style&&(a.attribs.style=t.getStyleObjectFromString(a.attribs.style)),v.createElement("button",_()({},a.attribs,{onClick:function(e){return t.abstractClick(s,e)}}),(0,y.domToReact)(a.children))}else if(a.name&&"a"===a.name){if(s.onclick)return a.attribs.style&&(a.attribs.style=t.getStyleObjectFromString(a.attribs.style)),v.createElement("a",_()({},a.attribs,{onClick:function(e){return t.abstractClick(s,e)}}),(0,y.domToReact)(a.children))}else if(a.name&&"select"===a.name){if(s.onchange)return a.attribs.style&&(a.attribs.style=t.getStyleObjectFromString(a.attribs.style)),v.createElement("select",_()({},a.attribs,{onChange:function(e){return t.abstractClick(s,e)}}),(0,y.domToReact)(a.children))}else if(a.name&&"input"===a.name){if(a.attribs.type&&"checkbox"==a.attribs.type&&s.onchange)return a.attribs.style&&(a.attribs.style=t.getStyleObjectFromString(a.attribs.style)),v.createElement("input",_()({type:"checkbox"},a.attribs,{onChange:function(e){return t.abstractClick(s,e)}}))}else if(a.name&&"script"===a.name&&a.attribs["data-bot-action"])return 1==t.state.jsExecuted||(t.setState({jsExecuted:!0}),(0,S.bQ)(a,t)),v.createElement(v.Fragment,null)}}});return v.createElement(v.Fragment,null,1==this.props.hasNew&&this.props.id==this.props.newId&&v.createElement("div",{id:"scroll-to-message",className:"message-admin border-bottom new-msg-holder border-danger text-center"},v.createElement("span",{className:"new-msg bg-danger text-white d-inline-block fs12 rounded-top"},this.props.newTitle)),a)}}]),n}(v.PureComponent),M=(0,D.Z)()((0,w.$j)()(x)),T=a(2446),R=a(8926),A=a.n(R),B=a(7757),N=a.n(B);function O(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function P(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?O(Object(a),!0).forEach((function(e){f()(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var F=function(t){l()(r,t);var e,a,s,n=(a=r,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=g()(a);if(s){var i=g()(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return p()(this,t)});function r(t){var e;return i()(this,r),e=n.call(this,t),f()(c()(e),"state",{hightlight:!1,files:[],uploading:!1,uploadProgress:{},successfullUploaded:!1}),e.fileInputRef=v.createRef(),e.openFileDialog=e.openFileDialog.bind(c()(e)),e.onFilesAddedUI=e.onFilesAddedUI.bind(c()(e)),e.onDragOver=e.onDragOver.bind(c()(e)),e.onDragLeave=e.onDragLeave.bind(c()(e)),e.onDrop=e.onDrop.bind(c()(e)),e.onPaste=e.onPaste.bind(c()(e)),e.onFilesAdded=e.onFilesAdded.bind(c()(e)),e.uploadFiles=e.uploadFiles.bind(c()(e)),e.sendRequest=e.sendRequest.bind(c()(e)),e}return o()(r,[{key:"onFilesAdded",value:function(t){var e=this,a=this.props.t,s=new RegExp("(.|/)("+this.props.fileOptions.get("ft_us")+")$","i"),i=[];t.forEach((function(t){s.test(t.type)||s.test(t.name)||i.push(t.name+": "+a("file.incorrect_type")),t.size>e.props.fileOptions.get("fs")&&i.push(t.name+": "+a("file.to_big_file"))})),i.length>0?alert(i.join("\n")):this.setState({files:t})}},{key:"componentDidUpdate",value:function(t,e){this.state.files.length>0&&0==this.state.uploading&&this.uploadFiles()}},{key:"uploadFiles",value:(e=A()(N().mark((function t(){var e,a=this;return N().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setState({uploadProgress:{},uploading:!0}),e=[],this.state.files.forEach((function(t){e.push(a.sendRequest(t))})),t.prev=3,t.next=6,Promise.all(e);case 6:this.setState({successfullUploaded:!0,uploading:!1,files:[]}),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3),this.setState({successfullUploaded:!0,uploading:!1,files:[]});case 12:case"end":return t.stop()}}),t,this,[[3,9]])}))),function(){return e.apply(this,arguments)})},{key:"sendRequest",value:function(t){var e=this,a=this.props.t;return new Promise((function(s,i){var n=new XMLHttpRequest;n.upload.addEventListener("progress",(function(s){s.lengthComputable&&(P({},e.state.uploadProgress)[t.name]={state:"pending",percentage:s.loaded/s.total*100},e.props.progress(a("file.uploading")+Math.round(s.loaded/s.total*100)+"%"))})),n.upload.addEventListener("load",(function(a){P({},e.state.uploadProgress)[t.name]={state:"done",percentage:100},e.props.progress("100%"),e.props.onCompletion(),s(n.response)})),n.upload.addEventListener("error",(function(a){var s=P({},e.state.uploadProgress);s[t.name]={state:"error",percentage:0},e.setState({uploadProgress:s}),i(n.response)}));var o=new FormData;o.append("files",t,t.name),n.open("POST",e.props.base_url+"/file/uploadfile/"+e.props.chat_id+"/"+e.props.hash),n.send(o)}))}},{key:"openFileDialog",value:function(){this.state.uploading||this.fileInputRef.current.click()}},{key:"onFilesAddedUI",value:function(t){var e=t.target.files,a=this.fileListToArray(e);this.onFilesAdded(a)}},{key:"onDragOver",value:function(t){t.preventDefault(),this.state.uploading||this.props.onDrag&&this.props.onDrag(!0)}},{key:"componentDidMount",value:function(){var t=this;setTimeout((function(){t.props.dropArea.current&&(t.props.dropArea.current.ondragover=t.onDragOver,t.props.dropArea.current.ondragleave=t.onDragLeave,t.props.dropArea.current.ondrop=t.onDrop,document.addEventListener("paste",t.onPaste),L.a.eventEmitter.addListener("fileupload",t.openFileDialog))}),1e3)}},{key:"componentWillUnmount",value:function(){this.props.dropArea.current&&(this.props.dropArea.current.ondragover=null,this.props.dropArea.current.ondragleave=null,this.props.dropArea.current.ondrop=null),L.a.eventEmitter.removeListener("fileupload",this.openFileDialog),document.removeEventListener("paste",this.onPaste)}},{key:"onPaste",value:function(t){var e=t&&t.clipboardData&&t.clipboardData.items;if(e&&e.length){for(var a=[],s=0;s<e.length;s++){var i=e[s].getAsFile&&e[s].getAsFile();i&&a.push(i)}a.length>0&&this.onFilesAdded(a)}}},{key:"onDragLeave",value:function(t){this.props.onDrag&&this.props.onDrag(!1)}},{key:"onDrop",value:function(t){if(t.preventDefault(),!this.state.uploading){var e=t.dataTransfer.files,a=this.fileListToArray(e);this.onFilesAdded(a),this.props.onDrag&&this.props.onDrag(!1)}}},{key:"fileListToArray",value:function(t){for(var e=[],a=0;a<t.length;a++)e.push(t.item(a));return e}},{key:"render",value:function(){if(this.props.link)return v.createElement(v.Fragment,null,v.createElement("input",{onChange:this.onFilesAddedUI,ref:this.fileInputRef,id:"fileupload",type:"file",name:"files[]",multiple:!this.props.fileOptions.has("one_file_upload"),className:"d-none"}),v.createElement("a",{className:"file-uploader",onClick:this.openFileDialog},v.createElement("i",{className:"material-icons chat-setting-item text-muted"},"")))}}]),r}(v.PureComponent),U=(0,D.Z)()(F);var j=function(t){l()(n,t);var e,a,s=(e=n,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,s=g()(e);if(a){var i=g()(this).constructor;t=Reflect.construct(s,arguments,i)}else t=s.apply(this,arguments);return p()(this,t)});function n(t){var e;return i()(this,n),e=s.call(this,t),f()(c()(e),"state",{intervalId:null,intervalCheckStatusId:null}),e.syncChat=e.syncChat.bind(c()(e)),e.checkStatusChat=e.checkStatusChat.bind(c()(e)),e}return o()(n,[{key:"syncChat",value:function(t){this.state.intervalId&&clearTimeout(this.state.intervalId),this.props.updateMessages(),this.setState({intervalId:setTimeout(this.syncChat,this.props.syncInterval)})}},{key:"checkStatusChat",value:function(){this.state.intervalCheckStatusId&&clearTimeout(this.state.intervalCheckStatusId),this.props.updateStatus(),this.setState({intervalCheckStatusId:setTimeout(this.checkStatusChat,this.props.syncInterval)})}},{key:"componentDidMount",value:function(){this.syncChat(),this.checkStatusChat()}},{key:"componentDidUpdate",value:function(t,e){this.props.status==I.sk||this.props.status_sub==I.Pd||this.props.status_sub==I.pV||this.props.status_sub==I.B4?(this.state.intervalId&&(clearTimeout(this.state.intervalId),this.state.intervalId=null),L.a.sendMessageParent("chatClosed",[])):this.state.intervalId||this.syncChat(),this.props.status_sub==t.status_sub&&this.props.status==t.status&&this.props.initClose==t.initClose&&t.hasSurvey==this.props.hasSurvey||this.checkStatusChat(),this.props.status!=I.sk&&this.props.status!=I.pA&&this.props.status!=I.XI&&this.props.status_sub!=I.Pd||!this.state.intervalCheckStatusId||0!=this.props.hasSurvey||(clearTimeout(this.state.intervalCheckStatusId),this.state.intervalCheckStatusId=null)}},{key:"componentWillUnmount",value:function(){this.state.intervalId&&clearTimeout(this.state.intervalId),this.state.intervalCheckStatusId&&clearTimeout(this.state.intervalCheckStatusId)}},{key:"render",value:function(){return null}}]),n}(v.PureComponent);var H,z=function(t){l()(r,t);var e,s,n=(e=r,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,a=g()(e);if(s){var i=g()(this).constructor;t=Reflect.construct(a,arguments,i)}else t=a.apply(this,arguments);return p()(this,t)});function r(t){var e;return i()(this,r),e=n.call(this,t),f()(c()(e),"state",{dropdown:null}),e}return o()(r,[{key:"componentDidMount",value:function(){if(document.getElementById(this.props.elementId)){var t=a(9539);this.setState({dropdown:new t.Dropdown(document.getElementById(this.props.elementId))})}}},{key:"componentWillUnmount",value:function(){this.state.dropdown&&delete this.state.dropdown}},{key:"render",value:function(){return this.props.children}}]),r}(v.PureComponent),V=a(9669),X=a.n(V);var Y=(0,w.$j)((function(t){return{chat:t.chatwidget.get("chatData"),chat_ui:t.chatwidget.get("chat_ui")}}))(H=function(t){l()(n,t);var e,a,s=(e=n,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,s=g()(e);if(a){var i=g()(this).constructor;t=Reflect.construct(s,arguments,i)}else t=s.apply(this,arguments);return p()(this,t)});function n(t){var e;return i()(this,n),(e=s.call(this,t)).abstractClick=e.abstractClick.bind(c()(e)),e.checkSwitchButtom=e.checkSwitchButtom.bind(c()(e)),e}return o()(n,[{key:"abstractClick",value:function(t){var e=this;t.onclick&&("lhinst.voteAction($(this))"==t.onclick?(0,S.jf)({id:this.props.chat.get("id"),hash:this.props.chat.get("hash"),type:t["data-id"]}).then((function(t){e.props.updateStatus()})):"notificationsLHC.sendNotification()"==t.onclick?L.a.sendMessageParent("subscribeEvent",[{pk:this.props.chat_ui.get("notifications_pk")}]):-1!==t.onclick.indexOf("lhinst.transferToHuman")?(0,S.ER)({id:this.props.chat.get("id"),hash:this.props.chat.get("hash")}).then((function(t){e.props.updateStatus()})):L.a.emitEvent("StatusClick",[t,this.props.dispatch]))}},{key:"checkSwitchButtom",value:function(){this.props.chat_ui.has("switch_to_human")&&this.props.vtm&&this.props.vtm>=this.props.chat_ui.get("switch_to_human")&&X().get(window.lhcChat.base_url+"restapi/isonlinechat/"+this.props.chat.get("id")+"?exclude_bot=true").then((function(t){if(t.data.isonline){var e=document.getElementById("transfer-to-human-btn");null!==e&&e.classList.remove("hide")}}))}},{key:"componentDidMount",value:function(){this.checkSwitchButtom()}},{key:"componentDidUpdate",value:function(t,e,a){this.checkSwitchButtom()}},{key:"render",value:function(){var t=this;return b()(this.props.status,{replace:function(e){if(e.attribs&&e.attribs.onclick&&e.name&&("i"==e.name||"a"==e.name)){var a=Object.assign({},e.attribs);return e.attribs.class&&(e.attribs.className=e.attribs.class,delete e.attribs.class),e.attribs.onclick&&delete e.attribs.onclick,v.createElement("i",_()({},e.attribs,{onClick:function(e){return t.abstractClick(a)}}),(0,y.domToReact)(e.children))}}})}}]),n}(v.PureComponent))||H;var W,Z=function(t){l()(n,t);var e,a,s=(e=n,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,s=g()(e);if(a){var i=g()(this).constructor;t=Reflect.construct(s,arguments,i)}else t=s.apply(this,arguments);return p()(this,t)});function n(t){return i()(this,n),s.call(this,t)}return o()(n,[{key:"render",value:function(){return v.createElement(v.Fragment,null,null!==this.props.profileBefore&&v.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.profileBefore}}),v.createElement("div",{className:this.props.msg_expand,id:"messagesBlock",dangerouslySetInnerHTML:{__html:this.props.messagesBefore}}),!this.props.hideMessageField&&v.createElement("div",{className:"d-flex flex-row border-top position-relative message-send-area"},v.createElement("div",{className:"btn-group dropup disable-select pl-2 pt-2"},v.createElement("i",{className:"material-icons settings text-muted","aria-haspopup":"true","aria-expanded":"false"},"")),v.createElement("div",{className:"mx-auto pb-1 w-100"},v.createElement("textarea",{"aria-label":"Type your message here...",placeholder:this.props.placeholderMessage,id:"CSChatMessage",rows:"1",className:"pl-0 no-outline form-control rounded-0 form-control border-left-0 border-right-0 border-0"})),v.createElement("div",{className:"disable-select"},v.createElement("div",{className:"user-chatwidget-buttons pt-1",id:"ChatSendButtonContainer"},v.createElement("i",{className:"material-icons text-muted settings mr-0"},"")))))}}]),n}(v.PureComponent),$=a(6313);function K(t,e){var a="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!a){if(Array.isArray(t)||(a=function(t,e){if(t){if("string"==typeof t)return q(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?q(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){a&&(t=a);var s=0,i=function(){};return{s:i,n:function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o=!0,r=!1;return{s:function(){a=a.call(t)},n:function(){var t=a.next();return o=t.done,t},e:function(t){r=!0,n=t},f:function(){try{o||null==a.return||a.return()}finally{if(r)throw n}}}}function q(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,s=new Array(e);a<e;a++)s[a]=t[a];return s}var G=v.lazy((function(){return a.e(218).then(a.bind(a,2218))})),Q=v.lazy((function(){return a.e(800).then(a.bind(a,5800))})),J=v.lazy((function(){return a.e(815).then(a.bind(a,5815))})),tt=(0,w.$j)((function(t){return{chatwidget:t.chatwidget}}))(W=function(t){l()(n,t);var e,a,s=(e=n,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,s=g()(e);if(a){var i=g()(this).constructor;t=Reflect.construct(s,arguments,i)}else t=s.apply(this,arguments);return p()(this,t)});function n(t){var e;return i()(this,n),e=s.call(this,t),f()(c()(e),"state",{value:"",valueSend:!1,showBBCode:null,mailChat:!1,dragging:!1,enabledEditor:!0,showMessages:!1,preloadSurvey:!1,gotToSurvey:!1,voiceMode:!1,showMail:!1,changeFontSize:!1,errorMode:!1,hasNew:!1,newId:0,scrollButton:!1,fontSize:100,otm:0}),f()(c()(e),"insertText",(function(t){var a=e.textMessageRef.current.selectionStart;e.setState({value:e.state.value.substring(0,a)+t+e.state.value.substring(a)})})),e.props.dispatch((0,S.Rt)({id:e.props.chatwidget.getIn(["chatData","id"]),hash:e.props.chatwidget.getIn(["chatData","hash"]),theme:e.props.chatwidget.get("theme")})),e.updateMessages(),e.updateStatus(),e.enterKeyDown=e.enterKeyDown.bind(c()(e)),e.handleChange=e.handleChange.bind(c()(e)),e.sendMessage=e.sendMessage.bind(c()(e)),e.endChat=e.endChat.bind(c()(e)),e.mailChat=e.mailChat.bind(c()(e)),e.changeFont=e.changeFont.bind(c()(e)),e.voiceCall=e.voiceCall.bind(c()(e)),e.toggleModal=e.toggleModal.bind(c()(e)),e.setStatusText=e.setStatusText.bind(c()(e)),e.dragging=e.dragging.bind(c()(e)),e.scrollBottom=e.scrollBottom.bind(c()(e)),e.focusMessage=e.focusMessage.bind(c()(e)),e.setEditorEnabled=e.setEditorEnabled.bind(c()(e)),e.sendDelay=e.sendDelay.bind(c()(e)),e.unhideDelayed=e.unhideDelayed.bind(c()(e)),e.toggleSound=e.toggleSound.bind(c()(e)),e.goToSurvey=e.goToSurvey.bind(c()(e)),e.startVoiceRecording=e.startVoiceRecording.bind(c()(e)),e.cancelVoiceRecording=e.cancelVoiceRecording.bind(c()(e)),e.onScrollMessages=e.onScrollMessages.bind(c()(e)),e.scrollToMessage=e.scrollToMessage.bind(c()(e)),e.changeFontAction=e.changeFontAction.bind(c()(e)),e.messagesAreaRef=v.createRef(),e.textMessageRef=v.createRef(),e.updateMessages=e.updateMessages.bind(c()(e)),e.updateStatus=e.updateStatus.bind(c()(e)),e.abstractAction=e.abstractAction.bind(c()(e)),e.updateMetaAutoHide=e.updateMetaAutoHide.bind(c()(e)),e.setMetaUpdateState=e.setMetaUpdateState.bind(c()(e)),e.keyUp=e.keyUp.bind(c()(e)),e.delayed=!1,e.delayQueue=[],e.intervalPending=null,e.intervalFunction=null,e.unhideDelayedTimer=null,e.pendingMetaUpdate=!1,e.timeoutNewMessage=null,e.isTyping=!1,e.typingStopped=null,e.typingStoppedAction=e.typingStoppedAction.bind(c()(e)),e.currentMessageTyping="",e}return o()(n,[{key:"dragging",value:function(t){this.setState({dragging:t})}},{key:"goToSurvey",value:function(){this.props.dispatch({type:"UI_STATE",data:{attr:"show_survey",val:1}}),this.setState({gotToSurvey:!0})}},{key:"setStatusText",value:function(t){this.props.dispatch({type:"chat_status_changed",data:{text:t}})}},{key:"startVoiceRecording",value:function(){this.setState({voiceMode:!0})}},{key:"cancelVoiceRecording",value:function(){this.setState({voiceMode:!1})}},{key:"handleChange",value:function(t){this.setState({value:t.target.value}),L.a.setSessionStorage("_ttxt",t.target.value)}},{key:"onScrollMessages",value:function(){this.messagesAreaRef.current&&(this.messagesAreaRef.current.scrollHeight-this.messagesAreaRef.current.scrollTop-this.messagesAreaRef.current.offsetHeight>70?!0!==this.state.scrollButton&&this.setState({scrollButton:!0}):!1!==this.state.scrollButton&&this.setState({scrollButton:!1,otm:0}))}},{key:"scrollToMessage",value:function(){var t=this;if(1==this.state.hasNew&&(clearTimeout(this.timeoutNewMessage),this.timeoutNewMessage=setTimeout((function(){t.setState({hasNew:!1,newId:0})}),1e3)),1==this.state.hasNew&&this.state.otm>0){this.setState({otm:0});try{document.getElementById("scroll-to-message").scrollIntoView()}catch(t){this.scrollBottom()}}else this.scrollBottom()}},{key:"changeFontAction",value:function(t){this.setState({fontSize:this.state.fontSize+(1==t?5:-5)}),L.a.setLocalStorage("_dfs",this.state.fontSize),this.scrollBottom()}},{key:"componentDidMount",value:function(){var t=L.a.getSessionStorage("_ttxt");null!==t&&this.setState({value:t});var e=L.a.getLocalStorage("_dfs");null!==e&&this.setState({fontSize:parseInt(e)});var a=document.getElementById("CSChatMessage");if(null!==a&&(!0===this.props.chatwidget.get("shown")&&"widget"==this.props.chatwidget.get("mode")||"popup"==this.props.chatwidget.get("mode"))){a.focus();var s=document.getElementById("CSChatMessage-tmp");null!==s&&document.body.removeChild(s)}}},{key:"focusMessage",value:function(){this.textMessageRef.current&&(this.textMessageRef.current.focus(),this.state.value.length>0&&(this.textMessageRef.current.selectionStart=this.state.value.length,this.textMessageRef.current.selectionEnd=this.state.value.length))}},{key:"setEditorEnabled",value:function(t){this.setState({enabledEditor:t})}},{key:"hasClass",value:function(t,e){return new RegExp("(\\s|^)"+e+"(\\s|$)").test(t.className)}},{key:"addClass",value:function(t,e){this.hasClass(t,e)||(t.className+=(t.className?" ":"")+e)}},{key:"removeClass",value:function(t,e){this.hasClass(t,e)&&(t.className=t.className.replace(new RegExp("(\\s|^)"+e+"(\\s|$)")," ").replace(/^\s+|\s+$/g,""))}},{key:"setMetaUpdateState",value:function(t){!1===t&&!0===this.pendingMetaUpdate&&(this.pendingMetaUpdate=!1,this.updateMetaAutoHide(!0),this.doScrollBottom()),!0===t&&(this.pendingMetaUpdate=!0,this.updateMetaAutoHide(),this.doScrollBottom())}},{key:"updateMetaAutoHide",value:function(t){var e=document.getElementById("messages-scroll"),a=e.getElementsByClassName("meta-auto-hide");if(a.length>0){var s=t?0:1;for(i=0;i<a.length-s;i++)a[i].style.display="none";var i,n=e.lastChild;if(n&&void 0!==n.getElementsByClassName)for(a=n.getElementsByClassName("meta-auto-hide"),i=0;i<a.length;i++)a[i].style.display=""}}},{key:"nextUntil",value:function(t,e){for(var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=[],n=!0;t=t.nextElementSibling;)n&&t&&!t.matches(e)==a?i.push(t):n=s;return i}},{key:"sendDelay",value:function(t){var e=this,a=t.id,s=t.duration,i=t.delay,n=t.untill_message,o=document.getElementById("msg-"+a);o&&(i>0&&this.addClass(o,"hide"),1==n&&this.nextUntil(o,".message-admin",!1,!0).length>0||setTimeout((function(){if(0==e.delayed)if(1==n)null!==e.intervalFunction&&e.intervalFunction(),e.intervalFunction=function(){if(e.nextUntil(o,".message-admin",!1,!0).length>0)o.parentNode.removeChild(o),e.scrollBottom(),e.intervalFunction=null,clearInterval(e.intervalPending);else if(!e.hasClass(o,"meta-hider")){e.addClass(o,"meta-hider"),e.addClass(o,"message-row-typing"),e.removeClass(o,"hide"),e.removeClass(o,"fade-in-fast");var t,a=K(o.getElementsByClassName("msg-body"));try{for(a.s();!(t=a.n()).done;){var s=t.value;e.removeClass(s,"hide")}}catch(t){a.e(t)}finally{a.f()}e.scrollBottom()}},clearInterval(e.intervalPending),e.intervalPending=setInterval(e.intervalFunction,150);else{e.delayed=!0,e.addClass(o,"meta-hider"),e.addClass(o,"message-row-typing"),e.nextUntil(o,".meta-hider").forEach((function(t){e.addClass(t,"hide")})),e.unhideDelayedTimer=setTimeout((function(){e.unhideDelayed(a)}),1e3*s),e.removeClass(o,"hide"),e.removeClass(o,"fade-in-fast");var t,r=K(o.getElementsByClassName("msg-body"));try{for(r.s();!(t=r.n()).done;){var c=t.value;e.removeClass(c,"hide")}}catch(t){r.e(t)}finally{r.f()}i>0&&(e.updateMetaAutoHide(),e.scrollBottom())}else e.addClass(o,"message-row-typing"),e.addClass(o,"meta-hider"),e.delayQueue.push({id:a,delay:s})}),1e3*i))}},{key:"unhideDelayed",value:function(t){var e=this,a=document.getElementById("msg-"+t);if(a)if(this.nextUntil(a,".meta-hider").forEach((function(t){e.removeClass(t,"hide")})),a.parentNode.removeChild(a),this.updateMetaAutoHide(),this.scrollBottom(),this.delayQueue.length>0){var s=this.delayQueue.shift();setTimeout((function(){e.unhideDelayed(s.id)}),1e3*s.delay);var i=document.getElementById("msg-"+s.id);if(null!==i){this.removeClass(i,"hide"),this.removeClass(i,"fade-in-fast");var n,o=K(i.getElementsByClassName("msg-body"));try{for(o.s();!(n=o.n()).done;){var r=n.value;this.removeClass(r,"hide")}}catch(t){o.e(t)}finally{o.f()}}}else this.delayed=!1}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalPending),clearInterval(this.typingStopped),clearTimeout(this.unhideDelayedTimer),clearTimeout(this.timeoutNewMessage)}},{key:"getSnapshotBeforeUpdate",value:function(t,e){if(t.chatwidget.getIn(["chatLiveData","messages"]).size!=this.props.chatwidget.getIn(["chatLiveData","messages"]).size){var a=!1,s=!0,i=0;this.messagesAreaRef.current&&((i=this.messagesAreaRef.current.scrollHeight-this.messagesAreaRef.current.scrollTop)-this.messagesAreaRef.current.offsetHeight<70?i=0:s=!1,a=!0);var n=this.state.hasNew,o=1==n?this.state.newId:0,r=1==n?this.state.otm:0;if(0!=t.chatwidget.getIn(["chatLiveData","messages"]).size&&!1===this.props.chatwidget.getIn(["chatLiveData","uw"])){var c=this.props.chatwidget.get("shown")&&"widget"==this.props.chatwidget.get("mode")||"widget"!=this.props.chatwidget.get("mode")&&document.hasFocus();0==n?(o=1==(n=0==c||0==window.lhcChat.is_focused||0==s)?t.chatwidget.getIn(["chatLiveData","messages"]).size:0,r=this.props.chatwidget.getIn(["chatLiveData","otm"])):r+=this.props.chatwidget.getIn(["chatLiveData","otm"]);var h=this.props.chatwidget.hasIn(["chat_ui","msg_snippet"])&&this.props.chatwidget.getIn(["chatLiveData","messages",-1,"msg"]);L.a.emitEvent("play_sound",[{msop:this.props.chatwidget.getIn(["chatLiveData","msop"]),msg_body:h,otm:r,type:"new_message",sound_on:!0===this.props.chatwidget.getIn(["usersettings","soundOn"]),widget_open:c}])}else n=!1,o=0,r=0;if(this.setState({valueSend:!1,hasNew:n,newId:o,otm:r,scrollButton:!s}),1==a)return i}else{if(!1===t.chatwidget.get("shown")&&!0===this.props.chatwidget.get("shown"))return 0;this.props.chatwidget.getIn(["chatLiveData","error"])&&(this.props.chatwidget.getIn(["chatLiveData","lmsg"])&&(0==this.state.errorMode||this.props.chatwidget.getIn(["chatLiveData","lmsg"])!=t.chatwidget.getIn(["chatLiveData","lmsg"]))||!this.props.chatwidget.getIn(["chatLiveData","lmsg"])&&0==this.state.errorMode)?this.setState({errorMode:!0,valueSend:!1,value:this.props.chatwidget.getIn(["chatLiveData","lmsg"])}):!this.props.chatwidget.getIn(["chatLiveData","error"])&&t.chatwidget.getIn(["chatLiveData","error"])&&this.setState({errorMode:!1,valueSend:!1,value:""})}return null}},{key:"componentDidUpdate",value:function(t,e,a){var s=this;!1!==this.state.showMessages&&t.chatwidget.getIn(["chatLiveData","status"])==this.props.chatwidget.getIn(["chatLiveData","status"])||(1==this.props.chatwidget.get("newChat")&&1==this.props.chatwidget.getIn(["chatLiveData","messages"]).size?this.scrollBottom(!1,!0):this.scrollBottom(!1,!1));var i=!1;if((!1===e.enabledEditor&&e.enabledEditor!=this.state.enabledEditor||this.props.chatwidget.get("msgLoaded")!==t.chatwidget.get("msgLoaded")&&(0==this.props.chatwidget.get("newChat")||1==(i=!0)))&&(0==i?this.scrollBottom(!1,!1):this.scrollBottom(!1,!0),(!0!==this.props.chatwidget.getIn(["chat_ui","auto_start"])||"embed"!=this.props.chatwidget.get("mode")||!1===this.props.chatwidget.getIn(["chat_ui","auto_start"])&&"embed"==this.props.chatwidget.get("mode")||!1===e.enabledEditor&&e.enabledEditor!=this.state.enabledEditor)&&(this.focusMessage(),setTimeout((function(){s.focusMessage()}),500))),null!==a&&this.messagesAreaRef.current){var n=document.getElementById("messages-scroll"),o=document.getElementById("msg-"+this.props.chatwidget.getIn(["chatLiveData","lfmsgid"]));n&&o&&n.scrollHeight-n.offsetHeight>o.offsetTop?(this.setState({scrollButton:!0}),this.messagesAreaRef.current.scrollTop=o.offsetTop):this.messagesAreaRef.current.scrollTop=this.messagesAreaRef.current.scrollHeight-a}if(1==this.props.chatwidget.getIn(["chat_ui_state","confirm_close"])&&!1===this.state.preloadSurvey&&this.setState({preloadSurvey:!0}),!1===t.chatwidget.get("shown")&&!0===this.props.chatwidget.get("shown")&&"widget"==this.props.chatwidget.get("mode")&&this.textMessageRef.current&&this.textMessageRef.current.focus(),!0!==this.props.chatwidget.getIn(["chat_ui","start_on_close"])||!0!==this.props.chatwidget.getIn(["chatLiveData","closed"])||void 0!==t.chatwidget.getIn(["chatLiveData","closed"])&&!1!==t.chatwidget.hasIn(["chatLiveData","closed"])&&!1!==t.chatwidget.getIn(["chatLiveData","closed"])||this.props.chatwidget.getIn(["chat_ui","survey_id"])||this.props.endChat({show_start:this.props.chatwidget.get("shown")}),!0===this.props.chatwidget.getIn(["chatLiveData","closed"])&&0===this.props.chatwidget.getIn(["chatLiveData","status_sub"])&&5===t.chatwidget.getIn(["chatLiveData","status_sub"])&&this.props.dispatch((0,S.Rt)({id:this.props.chatwidget.getIn(["chatData","id"]),hash:this.props.chatwidget.getIn(["chatData","hash"]),theme:this.props.chatwidget.get("theme")})),!(!0!==this.props.chatwidget.get("shown")||"widget"!=this.props.chatwidget.get("mode")&&"embed"!=this.props.chatwidget.get("mode")||!0!==this.props.chatwidget.get("initLoaded")||!0!==this.props.chatwidget.get("msgLoaded")||0!=t.chatwidget.get("msgLoaded")&&0!=t.chatwidget.get("initLoaded"))){"widget"==this.props.chatwidget.get("mode")&&this.textMessageRef.current&&this.textMessageRef.current.focus();var r=document.getElementById("CSChatMessage-tmp");null!==r&&document.body.removeChild(r)}}},{key:"doScrollBottom",value:function(t){var e;this.messagesAreaRef.current&&(t&&null!==(e=document.getElementById("msg-"+this.props.chatwidget.getIn(["chatLiveData","lfmsgid"])))?this.messagesAreaRef.current.scrollTop=e.offsetTop:this.messagesAreaRef.current.scrollTop=this.messagesAreaRef.current.scrollHeight+1e3)}},{key:"scrollBottom",value:function(t,e){var a=this;!this.messagesAreaRef.current||t&&this.state.scrollButton||(this.doScrollBottom(e),setTimeout((function(){a.doScrollBottom(e),!1===a.state.showMessages&&a.setState({showMessages:!0})}),450))}},{key:"abstractAction",value:function(t,e){L.a.emitEvent(t,e)}},{key:"updateMessages",value:function(){var t={chat_id:this.props.chatwidget.getIn(["chatData","id"]),hash:this.props.chatwidget.getIn(["chatData","hash"]),lmgsid:this.props.chatwidget.getIn(["chatLiveData","lmsgid"]),theme:this.props.chatwidget.get("theme"),new_chat:this.props.chatwidget.get("newChat")};t.new_chat&&0===t.lmgsid&&(t.old_msg_id=this.props.chatwidget.getIn(["chatData","lmsg_id"])),this.props.dispatch((0,S.W4)(t))}},{key:"updateStatus",value:function(){this.props.dispatch((0,S.kW)({chat_id:this.props.chatwidget.getIn(["chatData","id"]),hash:this.props.chatwidget.getIn(["chatData","hash"]),theme:this.props.chatwidget.get("theme"),mode:this.props.chatwidget.get("mode")}))}},{key:"sendMessage",value:function(){L.a.setSessionStorage("_ttxt",""),this.props.dispatch((0,S.Hz)({id:this.props.chatwidget.getIn(["chatData","id"]),hash:this.props.chatwidget.getIn(["chatData","hash"]),msg:this.state.value,mn:this.props.chatwidget.hasIn(["chat_ui","mn"]),theme:this.props.chatwidget.get("theme"),lmgsid:this.props.chatwidget.getIn(["chatLiveData","lmsgid"])})),this.setState({value:"",valueSend:!0,errorMode:!1}),this.currentMessageTyping="",this.focusMessage(),this.doScrollBottom()}},{key:"enterKeyDown",value:function(t){"Enter"!==t.key||t.shiftKey||(this.sendMessage(),t.preventDefault())}},{key:"keyUp",value:function(t){"Enter"===t.key||t.shiftKey||(!1===this.isTyping?(this.isTyping=!0,this.props.dispatch((0,S.Hx)("true",this.state.value))):(clearTimeout(this.typingStopped),this.typingStopped=setTimeout(this.typingStoppedAction,6e3),this.currentMessageTyping!=this.state.value&&(Math.abs(this.currentMessageTyping.length-this.state.value.length)>6||this.props.chatwidget.get("overrides").contains("typing"))&&(this.currentMessageTyping=this.state.value,this.props.dispatch((0,S.Hx)("true",this.state.value)))))}},{key:"typingStoppedAction",value:function(){1==this.isTyping&&(this.isTyping=!1,this.props.dispatch((0,S.Hx)("false")))}},{key:"endChat",value:function(){this.props.endChat()}},{key:"toggleModal",value:function(){this.setState({showBBCode:!this.state.showBBCode}),this.state.showBBCode&&this.focusMessage()}},{key:"mailChat",value:function(){this.setState({showMail:!this.state.showMail})}},{key:"changeFont",value:function(){this.setState({changeFontSize:!this.state.changeFontSize})}},{key:"voiceCall",value:function(){var t=void 0!==window.screenLeft?window.screenLeft:window.screenX,e=void 0!==window.screenTop?window.screenTop:window.screenY,a=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,s=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,i=a/window.screen.availWidth,n=(a-parseInt(800))/2/i+t,o="scrollbars=yes,menubar=1,resizable=1,width=800,height=600,top="+((s-parseInt(600))/2/i+e)+",left="+n,r=window.open("",L.a.prefix+"_voice_popup_v2",o),c=!1,h=!1;try{!r||r.closed||void 0===r.closed||"about:blank"===r.location.href?(r=window.open(this.props.chatwidget.get("base_url")+"voicevideo/call/"+this.props.chatwidget.getIn(["chatData","id"])+"/"+this.props.chatwidget.getIn(["chatData","hash"]),L.a.prefix+"_voice_popup_v2",o),h=!0):c=!0}catch(t){c=!0}!r||r.closed||void 0===r.closed||1==h||!0===c&&r.focus()}},{key:"toggleSound",value:function(){this.props.dispatch({type:"toggleSound",data:!this.props.chatwidget.getIn(["usersettings","soundOn"])}),L.a.sendMessageParent("toggleSound",[{sender:"toolbarButton"}])}},{key:"render",value:function(){var t=this,e=this.props.t;if(!1===this.props.chatwidget.get("initLoaded")||!1===this.props.chatwidget.get("msgLoaded")){var a="flex-grow-1 overflow-scroll position-relative";return this.props.chatwidget.hasIn(["chat_ui","msg_expand"])&&(a="overflow-scroll position-relative"),v.createElement(Z,{profileBefore:this.props.profileBefore,msg_expand:a,messagesBefore:this.props.messagesBefore,placeholderMessage:this.props.chatwidget.hasIn(["chat_ui","placeholder_message"])?this.props.chatwidget.getIn(["chat_ui","placeholder_message"]):e("chat.type_here")})}if(this.props.chatwidget.hasIn(["chatLiveData","ru"])&&this.props.chatwidget.getIn(["chatLiveData","ru"]))return l=this.props.chatwidget.get("base_url")+this.props.chatwidget.getIn(["chatLiveData","ru"]),v.createElement(v.Fragment,null,v.createElement("iframe",{allowtransparency:"true",src:l,frameBorder:"0",className:"flex-grow-1 position-relative iframe-modal"}));if(this.props.chatwidget.get("chatLiveData").has("messages"))var s=this.props.chatwidget.getIn(["chatLiveData","messages"]).map((function(a,s){return v.createElement(M,{profilePic:t.props.chatwidget.get("profile_pic"),newTitle:t.props.chatwidget.getIn(["chat_ui","cnew_msgh"])||e("button.new"),newId:t.state.newId,hasNew:t.state.hasNew,voiceCall:t.voiceCall,endChat:t.props.endChat,setMetaUpdateState:t.setMetaUpdateState,sendDelay:t.sendDelay,setEditorEnabled:t.setEditorEnabled,abstractAction:t.abstractAction,updateStatus:t.updateStatus,focusMessage:t.focusMessage,updateMessages:t.updateMessages,scrollBottom:t.scrollBottom,id:s,key:"msg_"+s,msg:a})}));else s="";var i;i=!0===this.state.dragging?e("chat.drop_files"):this.props.chatwidget.getIn(["chatLiveData","closed"])?e("chat.chat_closed"):this.props.chatwidget.hasIn(["chat_ui","placeholder_message"])?this.props.chatwidget.getIn(["chat_ui","placeholder_message"]):e("chat.type_here"),a="flex-grow-1 overflow-scroll position-relative";var n="bottom-message px-1";this.props.chatwidget.hasIn(["chat_ui","msg_expand"])&&"embed"==this.props.chatwidget.get("mode")&&(a="overflow-scroll position-relative",n+=" position-relative");var o="mx-auto w-100";1==this.props.chatwidget.getIn(["chatLiveData","closed"])&&(o+="embed"==this.props.chatwidget.get("mode")?" pr-2":" pr-1");var r=!0,c=!1,h=!1,l="",d="flex-grow-1 position-relative iframe-modal content-loader",p=this.props.chatwidget.hasIn(["chatLiveData","status_sub"])&&(this.props.chatwidget.getIn(["chatLiveData","status_sub"])==I.Pd||this.props.chatwidget.getIn(["chatLiveData","status_sub"])==I.pV&&(this.props.chatwidget.getIn(["chatLiveData","uid"])>0||this.props.chatwidget.getIn(["chatLiveData","status"])===I.pA||this.props.chatwidget.getIn(["chatLiveData","status"])==I.sk))||this.props.chatwidget.getIn(["chatLiveData","status"])==I.sk&&this.props.chatwidget.getIn(["chatLiveData","uid"])>0||!0===this.state.gotToSurvey;(this.props.chatwidget.hasIn(["chatLiveData","status_sub"])&&this.props.chatwidget.getIn(["chatLiveData","status_sub"])==I.Pd||this.props.chatwidget.getIn(["chatLiveData","status"])==I.sk&&this.props.chatwidget.getIn(["chatLiveData","status_sub"])!=I.pV)&&(h=!0),(!0===this.state.preloadSurvey||p)&&this.props.chatwidget.hasIn(["chat_ui","survey_id"])&&(l=this.props.chatwidget.get("base_url")+"survey/fillwidget/(chatid)/"+this.props.chatwidget.getIn(["chatData","id"])+"/(hash)/"+this.props.chatwidget.getIn(["chatData","hash"]),this.props.chatwidget.get("theme")&&(l=l+"/(theme)/"+this.props.chatwidget.get("theme")),l=l+"/(survey)/"+this.props.chatwidget.getIn(["chat_ui","survey_id"])+(!0===h?"/(force)/true":""),this.props.chatwidget.hasIn(["chat_ui","survey_url"])&&(l=this.props.chatwidget.getIn(["chat_ui","survey_url"]).replace("{chat_id}",this.props.chatwidget.getIn(["chatData","id"])).replace("{chat_hash}",this.props.chatwidget.getIn(["chatData","hash"]))+(!0===h?"?force=true":"")),c=!0,r=!1,(!1===p||this.props.chatwidget.hasIn(["chat_ui","survey_button"])&&0===this.props.chatwidget.getIn(["chat_ui_state","show_survey"])&&this.props.chatwidget.getIn(["chatLiveData","status"])==I.sk&&this.props.chatwidget.getIn(["chatLiveData","status_sub"])!=I.Pd&&this.props.chatwidget.getIn(["chatLiveData","status_sub"])!=I.pV||1==this.props.chatwidget.getIn(["chat_ui_state","confirm_close"]))&&(r=!0,d=" d-none"));var u=this.props.chatwidget.getIn(["chat_ui","end_chat_text"])||e("button.end_chat"),g={fontSize:(this.props.chatwidget.hasIn(["chat_ui","font_size"])?this.state.fontSize:"100")+"%"};return v.createElement(v.Fragment,null,this.props.chatwidget.getIn(["chatLiveData","abort"])&&v.createElement($.Z,{closeText:e("button.close"),close:function(e){return t.props.dispatch((0,S.H7)(!0))},text:this.props.chatwidget.getIn(["chatLiveData","abort"])}),c&&v.createElement("iframe",{allowtransparency:"true",src:l,frameBorder:"0",className:d}),(r||c)&&v.createElement(j,{hasSurvey:c,syncInterval:this.props.chatwidget.getIn(["chat_ui","sync_interval"]),updateStatus:this.updateStatus,updateMessages:this.updateMessages,initClose:this.props.chatwidget.get("initClose"),dispatch:this.props.dispatch,status_sub:this.props.chatwidget.getIn(["chatLiveData","status_sub"]),status:this.props.chatwidget.getIn(["chatLiveData","status"]),theme:this.props.chatwidget.get("theme"),lmgsid:this.props.chatwidget.getIn(["chatLiveData","lmsgid"]),hash:this.props.chatwidget.getIn(["chatData","hash"]),chat_id:this.props.chatwidget.getIn(["chatData","id"])}),r&&v.createElement(v.Fragment,null,1==this.props.chatwidget.getIn(["chat_ui_state","confirm_close"])&&v.createElement(T.Z,{confirmClose:this.props.endChat,cancelClose:this.props.cancelClose,toggle:this.props.cancelClose,dataUrl:"/chat/confirmleave/"+this.props.chatwidget.getIn(["chatData","id"])+"/"+this.props.chatwidget.getIn(["chatData","hash"])}),this.state.showBBCode&&v.createElement(T.Z,{showModal:this.state.showBBCode,insertText:this.insertText,toggle:this.toggleModal,dataUrl:"/chat/bbcodeinsert?react=1"}),this.state.showMail&&v.createElement(v.Suspense,{fallback:"..."},v.createElement(Q,{showModal:this.state.showMail,changeFont:this.changeFont,toggle:this.mailChat,chatHash:this.props.chatwidget.getIn(["chatData","hash"]),chatId:this.props.chatwidget.getIn(["chatData","id"])})),this.state.changeFontSize&&v.createElement(v.Suspense,{fallback:"..."},v.createElement(J,{showModal:this.state.changeFontSize,toggle:this.changeFont,changeFont:this.changeFontAction})),"embed"==this.props.chatwidget.get("mode")&&this.props.chatwidget.hasIn(["chat_ui","embed_cls"])&&1==this.props.chatwidget.getIn(["chat_ui","embed_cls"])&&v.createElement("div",{className:"close-modal-btn position-absolute"},this.props.chatwidget.hasIn(["chat_ui","close_btn"])&&v.createElement("a",{onClick:this.endChat,title:u},v.createElement("i",{className:"material-icons settings text-muted"},""),v.createElement("span",{className:"embed-close-title"},u))),this.props.chatwidget.hasIn(["chatStatusData","result"])&&!this.props.chatwidget.hasIn(["chat_ui","hide_status"])&&this.props.chatwidget.getIn(["chatStatusData","result"])&&v.createElement("div",{id:"chat-status-container",className:"p-2 border-bottom live-status-"+this.props.chatwidget.getIn(["chatLiveData","status"])},v.createElement(Y,{updateStatus:this.updateStatus,vtm:this.props.chatwidget.hasIn(["chat_ui","switch_to_human"])&&this.props.chatwidget.getIn(["chatLiveData","status"])==I.pA?this.props.chatwidget.getIn(["chatLiveData","vtm"]):0,status:this.props.chatwidget.getIn(["chatStatusData","result"])})),v.createElement("div",{className:a,id:"messagesBlock",onScroll:this.onScrollMessages},v.createElement("div",{className:n,id:"messages-scroll",style:g,ref:this.messagesAreaRef},this.props.chatwidget.hasIn(["chat_ui","prev_chat"])&&v.createElement("div",{dangerouslySetInnerHTML:{__html:this.props.chatwidget.getIn(["chat_ui","prev_chat"])}}),s),this.state.scrollButton&&v.createElement("div",{className:"position-absolute btn-bottom-scroll fade-in"},v.createElement("button",{type:"button",onClick:this.scrollToMessage,className:"btn btn-sm btn-secondary"},this.state.hasNew&&this.state.otm>0&&v.createElement("div",null,v.createElement("i",{className:"material-icons"},""),this.state.otm," ",1==this.state.otm?this.props.chatwidget.getIn(["chat_ui","cnew_msg"])||e("button.new_msg"):this.props.chatwidget.getIn(["chat_ui","cnew_msgm"])||e("button.new_msgm"))||this.props.chatwidget.getIn(["chat_ui","cscroll_btn"])||e("button.scroll_bottom")))),v.createElement("div",{className:(!1===this.props.chatwidget.get("msgLoaded")||!1===this.state.enabledEditor?"d-none ":"d-flex ")+"flex-row border-top position-relative message-send-area"},(this.props.chatwidget.getIn(["chatLiveData","ott"])||this.props.chatwidget.getIn(["chatLiveData","error"])&&"SEND_CONNECTION"!=this.props.chatwidget.getIn(["chatLiveData","error"])||this.props.chatwidget.get("network_down"))&&v.createElement("div",{id:"id-operator-typing",className:"bg-white pl-1"},this.props.chatwidget.getIn(["chatLiveData","error"])?-1===this.props.chatwidget.getIn(["chatLiveData","error"]).indexOf("SEND_")?this.props.chatwidget.getIn(["chatLiveData","error"]):e("online_chat."+this.props.chatwidget.getIn(["chatLiveData","error"]).toLowerCase()):this.props.chatwidget.get("network_down")?e("online_chat.send_connection"):this.props.chatwidget.getIn(["chatLiveData","ott"])),"embed"==this.props.chatwidget.get("mode")&&this.props.chatwidget.hasIn(["chat_ui","embed_cls"])&&2==this.props.chatwidget.getIn(["chat_ui","embed_cls"])&&v.createElement("div",{className:"inline-cls-btn pt-1 pl-2"},this.props.chatwidget.hasIn(["chat_ui","close_btn"])&&v.createElement("a",{onClick:this.endChat,title:u},v.createElement("i",{className:"material-icons settings text-muted mr-0"},""))),v.createElement(z,{elementId:"chat-dropdown-options"},v.createElement("div",{className:"btn-group dropup disable-select pl-1 pt-2"},v.createElement("i",{className:"material-icons settings text-muted",id:"chat-dropdown-options","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},""),v.createElement("div",{className:"dropdown-menu shadow bg-white rounded lhc-dropdown-menu ml-1 "+("rtl"==window.lhcChat.staticJS.dir?"dropdown-menu-right":"")},v.createElement("div",{className:"d-flex flex-row pl-1"},v.createElement("a",{onClick:this.toggleSound,title:e("chat.option_sound")},v.createElement("i",{className:"material-icons chat-setting-item text-muted"},!0===this.props.chatwidget.getIn(["usersettings","soundOn"])?v.createElement(v.Fragment,null,""):v.createElement(v.Fragment,null,""))),this.props.chatwidget.hasIn(["chat_ui","print"])&&v.createElement("a",{target:"_blank",href:this.props.chatwidget.get("base_url")+"chat/printchat/"+this.props.chatwidget.getIn(["chatData","id"])+"/"+this.props.chatwidget.getIn(["chatData","hash"]),title:e("button.print")},v.createElement("i",{className:"material-icons chat-setting-item text-muted"},"")),!this.props.chatwidget.getIn(["chatLiveData","closed"])&&this.props.chatwidget.hasIn(["chat_ui","file"])&&v.createElement(U,{fileOptions:this.props.chatwidget.getIn(["chat_ui","file_options"]),onDrag:this.dragging,dropArea:this.textMessageRef,onCompletion:this.updateMessages,progress:this.setStatusText,base_url:this.props.chatwidget.get("base_url"),chat_id:this.props.chatwidget.getIn(["chatData","id"]),hash:this.props.chatwidget.getIn(["chatData","hash"]),link:!0}),!this.props.chatwidget.getIn(["chatLiveData","closed"])&&1==this.props.chatwidget.getIn(["chatLiveData","status"])&&this.props.chatwidget.hasIn(["chat_ui","voice"])&&v.createElement("a",{onClick:this.voiceCall,title:e("button.voice")},v.createElement("i",{className:"material-icons chat-setting-item text-muted"},"")),!this.props.chatwidget.getIn(["chatLiveData","closed"])&&!this.props.chatwidget.hasIn(["chat_ui","bbc_btnh"])&&v.createElement("a",{onClick:this.toggleModal,title:e("button.bb_code")},v.createElement("i",{className:"material-icons chat-setting-item text-muted"},"")),this.props.chatwidget.hasIn(["chat_ui","mail"])&&v.createElement("a",{onClick:this.mailChat,title:e("button.mail")},v.createElement("i",{className:"material-icons chat-setting-item text-muted"},"")),this.props.chatwidget.hasIn(["chat_ui","font_size"])&&v.createElement("a",{onClick:function(e){return t.changeFont(e)}},v.createElement("i",{className:"material-icons chat-setting-item text-muted"},"")),this.props.chatwidget.hasIn(["chat_ui","close_btn"])&&v.createElement("a",{onClick:this.endChat,title:u},v.createElement("i",{className:"material-icons chat-setting-item text-muted"},"")))))),v.createElement("div",{className:o},this.props.chatwidget.getIn(["chatLiveData","closed"])&&this.props.chatwidget.hasIn(["chat_ui","survey_id"])&&v.createElement("button",{onClick:this.goToSurvey,className:"w-100 btn btn-success"},e("online_chat.go_to_survey")),(!this.props.chatwidget.getIn(["chatLiveData","closed"])||!this.props.chatwidget.hasIn(["chat_ui","survey_id"]))&&v.createElement("textarea",{onTouchStart:this.scrollBottom,maxLength:this.props.chatwidget.getIn(["chat_ui","max_length"]),onKeyUp:this.keyUp,readOnly:this.props.chatwidget.getIn(["chatLiveData","closed"])||this.props.chatwidget.get("network_down"),id:"CSChatMessage",placeholder:i,onKeyDown:this.enterKeyDown,value:this.props.chatwidget.getIn(["chatLiveData","closed"])?"":this.state.value,onChange:this.handleChange,ref:this.textMessageRef,rows:"1",className:"pl-0 no-outline form-control rounded-0 form-control border-left-0 border-right-0 border-0 "+(!0===this.props.chatwidget.get("shown")&&this.textMessageRef.current&&(/\r|\n/.exec(this.state.value)||this.state.value.length>this.textMessageRef.current.offsetWidth/8.6)?"msg-two-line":"msg-one-line")})),!this.props.chatwidget.getIn(["chatLiveData","closed"])&&!this.props.chatwidget.get("network_down")&&v.createElement("div",{className:"disable-select"},v.createElement("div",{className:"user-chatwidget-buttons pt-1 pr-1",id:"ChatSendButtonContainer"},!0===this.state.voiceMode&&v.createElement(v.Suspense,{fallback:"..."},v.createElement(G,{onCompletion:this.updateMessages,progress:this.setStatusText,base_url:this.props.chatwidget.get("base_url"),chat_id:this.props.chatwidget.getIn(["chatData","id"]),hash:this.props.chatwidget.getIn(["chatData","hash"]),maxSeconds:"30",cancel:this.cancelVoiceRecording})),!this.state.valueSend&&this.props.chatwidget.hasIn(["chat_ui","voice_message"])&&void 0!==window.Audio&&0==this.state.value.length&&!1===this.state.voiceMode&&v.createElement("a",{onClick:this.startVoiceRecording,title:e("button.record_voice")},v.createElement("i",{className:"material-icons text-muted settings mr-0"},"")),!this.state.valueSend&&(!this.props.chatwidget.hasIn(["chat_ui","voice_message"])||!(void 0!==window.Audio)||this.state.value.length>0&&!1===this.state.voiceMode)&&v.createElement("a",{onClick:this.sendMessage,title:e("button.send")},v.createElement("i",{className:"material-icons text-muted settings mr-0"},"")),this.state.valueSend&&v.createElement("i",{className:"material-icons text-muted settings mr-0"},""))))))}}]),n}(v.Component))||W,et=(0,D.Z)()(tt)},298:function(t){"use strict";function e(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,s)}return a}function a(t){for(var a,i=1;i<arguments.length;i++)a=null==arguments[i]?{}:arguments[i],i%2?e(Object(a),!0).forEach((function(e){s(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):e(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}));return t}function s(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}const i={threshold:50,passive:!1};t.exports=class{constructor(t,e={}){this.options=a(a({},i),e),this.element=null,this.touchStartX=0,this.touchStartY=0,this.touchEndX=0,this.touchEndY=0,this.onSwipeLeftAgent=null,this.onSwipeRightAgent=null,this.onSwipeUpAgent=null,this.onSwipeDownAgent=null,this.onTapAgent=null,this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onSwipeLeft=this.onSwipeLeft.bind(this),this.onSwipeRight=this.onSwipeRight.bind(this),this.onSwipeUp=this.onSwipeUp.bind(this),this.onSwipeDown=this.onSwipeDown.bind(this),this.onTap=this.onTap.bind(this),this.destroy=this.destroy.bind(this),this.handleGesture=this.handleGesture.bind(this);let s=!!this.options.passive&&{passive:!0};this.element=t instanceof EventTarget?t:document.querySelector(t),this.element.addEventListener("touchstart",this.onTouchStart,s),this.element.addEventListener("touchend",this.onTouchEnd,s)}onTouchStart(t){this.touchStartX=t.changedTouches[0].screenX,this.touchStartY=t.changedTouches[0].screenY}onTouchEnd(t){this.touchEndX=t.changedTouches[0].screenX,this.touchEndY=t.changedTouches[0].screenY,this.handleGesture()}onSwipeLeft(t){this.onSwipeLeftAgent=t}onSwipeRight(t){this.onSwipeRightAgent=t}onSwipeUp(t){this.onSwipeUpAgent=t}onSwipeDown(t){this.onSwipeDownAgent=t}onTap(t){this.onTapAgent=t}destroy(){this.element.removeEventListener("touchstart",this.onTouchStart),this.element.removeEventListener("touchend",this.onTouchEnd)}handleGesture(){return this.touchEndX+this.options.threshold<=this.touchStartX?(this.onSwipeLeftAgent&&this.onSwipeLeftAgent(),"swiped left"):this.touchEndX-this.options.threshold>=this.touchStartX?(this.onSwipeRightAgent&&this.onSwipeRightAgent(),"swiped right"):this.touchEndY+this.options.threshold<=this.touchStartY?(this.onSwipeUpAgent&&this.onSwipeUpAgent(),"swiped up"):this.touchEndY-this.options.threshold>=this.touchStartY?(this.onSwipeDownAgent&&this.onSwipeDownAgent(),"swiped down"):this.touchEndY===this.touchStartY?(this.onTapAgent&&this.onTapAgent(),"tap"):void 0}}}}]);
//# sourceMappingURL=981.d60aa07de627c283159e.js.map