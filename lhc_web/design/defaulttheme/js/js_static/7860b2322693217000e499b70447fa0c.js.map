{"version":3,"sources":["7860b2322693217000e499b70447fa0c.js"],"names":["services","factory","t","e","this","loadOnlineUsers","n","i","defer","get","WWW_DIR_JAVASCRIPT","timeout","department_dpgroups","length","join","department","max_rows","country","time_on_site","encodeURIComponent","then","resolve","data","promise","setLocalSettings","o","post","attr","val","reject","status","deleteOnlineUser","user_id","confLH","csrf_token","error_url","document","location","lhcAppControllers","controller","r","s","a","l","onlineusers","onlineusersPreviousID","onlineusersGrouped","updateTimeout","userTimeout","maxRows","predicate","reverse","wasInitiated","online_connected","attrf_key_1","attrf_val_1","attrf_key_2","attrf_val_2","attrf_key_3","attrf_val_3","attrf_key_4","attrf_val_4","attrf_key_5","attrf_val_5","forbiddenVisitors","soundEnabled","notificationEnabled","lastSyncSkipped","c","forEach","getElementById","MutationObserver","classList","contains","updateList","observe","attributes","attributeFilter","childList","characterData","groupByField","groupBy","sort","label","id","ou","push","lhinst","disableSync","ee","emitEvent","angular","indexOf","Modernizr","audio","Audio","src","ogg","WWW_DIR_JAVASCRIPT_FILES","mp3","load","setTimeout","play","window","webkitNotifications","Notification","checkPermission","createNotification","WWW_DIR_JAVASCRIPT_FILES_NOTIFICATION","ip","user_country_name","page_title","referrer","onclick","cancel","show","permission","icon","body","close","$watch","changeUserSettingsIndifferent","departmentChanged","productChanged","showOnlineUserInfo","lhc","revealModal","url","previewChat","chat_id","can_view_chat","sendMessage","deleteUser","confirm","splice","disableNewUserBNotif","changeUserSettings","showConnected","disableNewUserSound","initController","onlineAttributeFilter","$on"],"mappings":"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","file":"7860b2322693217000e499b70447fa0c.js","sourcesContent":["services.factory(\"OnlineUsersFactory\",[\"$http\",\"$q\",function(t,e){return this.loadOnlineUsers=function(n){var i=e.defer();return t.get(WWW_DIR_JAVASCRIPT+\"chat/onlineusers/(method)/ajax/(timeout)/\"+n.timeout+(n.department_dpgroups.length>0?\"/(department_dpgroups)/\"+n.department_dpgroups.join(\"/\"):\"\")+(n.department.length>0?\"/(department)/\"+n.department.join(\"/\"):\"\")+(n.max_rows>0?\"/(maxrows)/\"+n.max_rows:\"\")+(\"\"!=n.country?\"/(country)/\"+n.country:\"\")+(\"\"!=n.time_on_site?\"/(timeonsite)/\"+encodeURIComponent(n.time_on_site):\"\")).then((function(t){i.resolve(t.data)})),i.promise},this.setLocalSettings=function(n,i){var o=e.defer();return t.post(WWW_DIR_JAVASCRIPT+\"front/settings\",{attr:n,val:i}).then((function(t){o.resolve(t.data)}),(function(t){o.reject(void 0!==t.status?\"[\"+t.status+\"]\":\"[0]\")})),o.promise},this.deleteOnlineUser=function(n){var i=e.defer();return t.post(WWW_DIR_JAVASCRIPT+\"chat/onlineusers/(deletevisitor)/\"+n.user_id+\"/(csfr)/\"+confLH.csrf_token).then((function(t){void 0!==t.error_url?document.location=t.data.error_url:i.resolve(t.data)})),i.promise},this}]),lhcAppControllers.controller(\"OnlineCtrl\",[\"$scope\",\"$http\",\"$location\",\"$rootScope\",\"$log\",\"$interval\",\"$window\",\"OnlineUsersFactory\",function(t,e,n,i,o,r,s,a){var l;this.onlineusers=[],this.onlineusersPreviousID=[],t.onlineusersGrouped=[],this.updateTimeout=\"10\",this.userTimeout=\"3600\",this.maxRows=\"50\",this.department=[],this.department_dpgroups=[],this.country=\"none\",this.predicate=\"last_visit\",this.time_on_site=\"\",this.reverse=!0,this.wasInitiated=!1,this.online_connected=!1,this.attrf_key_1=\"\",this.attrf_val_1=\"\",this.attrf_key_2=\"\",this.attrf_val_2=\"\",this.attrf_key_3=\"\",this.attrf_val_3=\"\",this.attrf_key_4=\"\",this.attrf_val_4=\"\",this.attrf_key_5=\"\",this.attrf_val_5=\"\",this.forbiddenVisitors=!1,this.soundEnabled=!1,this.notificationEnabled=!1,this.lastSyncSkipped=!1;var c=this;!0!==c.forbiddenVisitors&&[\"onlineusers\",\"widget-onvisitors\",\"map\",\"dashboard\"].forEach((function(t){var e=document.getElementById(t);null!==e&&new MutationObserver((function(t){e.classList.contains(\"active\")&&1==c.lastSyncSkipped&&c.updateList()})).observe(e,{attributes:!0,attributeFilter:[\"class\"],childList:!1,characterData:!1})})),t.groupByField=\"none\",t.groupBy=function(e){var n,i;t.onlineusersGrouped=[],n=c.onlineusers,i=e,n.sort((function(t,e){return t[i]<=e[i]?-1:1}));for(var o=\"_INVALID_GROUP_VALUE_\",r=0;r<c.onlineusers.length;r++){var s=c.onlineusers[r];if(s[e]!==o){var a={label:s[e],id:r,ou:[]};o=a.label,t.onlineusersGrouped.push(a)}a.ou.push(s)}},this.updateList=function(){if(1!=lhinst.disableSync&&1!=c.forbiddenVisitors){var e=!1,n=document.getElementById(\"onlineusers\");if(null!==n&&(e=n.classList.contains(\"active\")),0==e){var i=document.getElementById(\"map\");null!==i&&(e=i.classList.contains(\"active\"))}if(0==e)if(null!==document.getElementById(\"widget-onvisitors-body\")){var o=document.getElementById(\"dashboard\");null!==o&&o.classList.contains(\"active\")&&(e=!0)}!1!==e?(c.lastSyncSkipped=!1,a.loadOnlineUsers({department_dpgroups:c.department_dpgroups,timeout:c.userTimeout,time_on_site:c.time_on_site,department:c.department,country:c.country,max_rows:c.maxRows}).then((function(e){if(c.onlineusers=e,\"none\"!=t.groupByField?t.groupBy(t.groupByField):(t.onlineusersGrouped=[],t.onlineusersGrouped.push({label:\"\",id:0,ou:c.onlineusers})),ee.emitEvent(\"chatAdminSyncOnlineVisitors\",[e]),c.notificationEnabled||c.soundEnabled){var n=!1,i=[];if(angular.forEach(c.onlineusers,(function(t,e){var o=!0;-1==c.onlineusersPreviousID.indexOf(t.id)&&(o=!1,c.onlineusersPreviousID.push(t.id)),1==c.wasInitiated&&0==o&&(n=!0,i.push(t))})),1==n){if(c.soundEnabled&&Modernizr.audio){var o=new Audio;o.src=Modernizr.audio.ogg?WWW_DIR_JAVASCRIPT_FILES+\"/new_visitor.ogg\":Modernizr.audio.mp3?WWW_DIR_JAVASCRIPT_FILES+\"/new_visitor.mp3\":WWW_DIR_JAVASCRIPT_FILES+\"/new_visitor.wav\",o.load(),setTimeout((function(){o.play()}),500)}c.notificationEnabled&&(window.webkitNotifications||window.Notification)&&angular.forEach(i,(function(t,e){if(window.webkitNotifications)0==window.webkitNotifications.checkPermission()&&((n=window.webkitNotifications.createNotification(WWW_DIR_JAVASCRIPT_FILES_NOTIFICATION+\"/notification.png\",t.ip+(\"\"!=t.user_country_name?\", \"+t.user_country_name:\"\"),(\"\"!=t.page_title?t.page_title+\"\\n-----\\n\":\"\")+(\"\"!=t.referrer?t.referrer+\"\\n-----\\n\":\"\"))).onclick=function(){n.cancel()},n.show(),setTimeout((function(){n.cancel()}),15e3));else if(window.Notification){var n;if(\"granted\"==window.Notification.permission)(n=new Notification(t.ip+(\"\"!=t.user_country_name?\", \"+t.user_country_name:\"\"),{icon:WWW_DIR_JAVASCRIPT_FILES_NOTIFICATION+\"/notification.png\",body:(\"\"!=t.page_title?t.page_title+\"\\n-----\\n\":\"\")+(\"\"!=t.referrer?t.referrer+\"\\n-----\\n\":\"\")})).onclick=function(){n.close()},setTimeout((function(){n.close()}),15e3)}}))}c.wasInitiated=!0,c.onlineusersPreviousID.length>100&&(c.wasInitiated=!1,c.onlineusersPreviousID=[])}}))):c.lastSyncSkipped=!0}},l=r((function(){0==c.forbiddenVisitors?c.updateList():r.cancel(l)}),1e3*this.updateTimeout),t.$watch(\"online.updateTimeout\",(function(t,e){t!=e&&(r.cancel(l),l=r((function(){c.updateList()}),1e3*t),lhinst.changeUserSettingsIndifferent(\"oupdate_timeout\",t))})),t.$watch(\"online.userTimeout\",(function(t,e){t!=e&&lhinst.changeUserSettingsIndifferent(\"ouser_timeout\",t)})),t.$watch(\"online.country\",(function(t,e){t!=e&&lhinst.changeUserSettingsIndifferent(\"ocountry\",t)})),t.$watch(\"online.time_on_site\",(function(t,e){t!=e&&lhinst.changeUserSettingsIndifferent(\"otime_on_site\",\"\"==t?\"none\":t)})),t.$watch(\"online.maxRows\",(function(t,e){t!=e&&lhinst.changeUserSettingsIndifferent(\"omax_rows\",t)})),t.$watch(\"online.attrf_key_1\",(function(t,e){t!=e&&lhinst.changeUserSettingsIndifferent(\"oattrf_key_1\",t)})),t.$watch(\"online.attrf_val_1\",(function(t,e){t!=e&&lhinst.changeUserSettingsIndifferent(\"oattrf_val_1\",t)})),t.$watch(\"online.attrf_key_2\",(function(t,e){t!=e&&lhinst.changeUserSettingsIndifferent(\"oattrf_key_2\",t)})),t.$watch(\"online.attrf_val_2\",(function(t,e){t!=e&&lhinst.changeUserSettingsIndifferent(\"oattrf_val_2\",t)})),t.$watch(\"online.attrf_key_3\",(function(t,e){t!=e&&lhinst.changeUserSettingsIndifferent(\"oattrf_key_3\",t)})),t.$watch(\"online.attrf_val_3\",(function(t,e){t!=e&&lhinst.changeUserSettingsIndifferent(\"oattrf_val_3\",t)})),t.$watch(\"online.attrf_key_4\",(function(t,e){t!=e&&lhinst.changeUserSettingsIndifferent(\"oattrf_key_4\",t)})),t.$watch(\"online.attrf_val_4\",(function(t,e){t!=e&&lhinst.changeUserSettingsIndifferent(\"oattrf_val_4\",t)})),t.$watch(\"online.attrf_key_5\",(function(t,e){t!=e&&lhinst.changeUserSettingsIndifferent(\"oattrf_key_5\",t)})),t.$watch(\"online.attrf_val_5\",(function(t,e){t!=e&&lhinst.changeUserSettingsIndifferent(\"oattrf_val_5\",t)})),this.departmentChanged=function(t){a.setLocalSettings(t+\"_online\",this[t])},this.productChanged=function(t){a.setLocalSettings(t+\"_online\",this[t])},t.$watch(\"groupByField\",(function(t,e){t!=e&&lhinst.changeUserSettingsIndifferent(\"ogroup_by\",t)})),t.$watch(\"online.userTimeout + online.department + online.department_dpgroups + online.maxRows + groupByField + online.country + online.time_on_site + online.attrf_key_1 + online.attrf_val_1 + online.attrf_key_2 + online.attrf_val_2 + online.attrf_key_3 + online.attrf_val_3 + online.attrf_key_4 + online.attrf_val_4 + online.attrf_key_5 + online.attrf_val_5\",(function(t,e){setTimeout((function(){c.updateList()}),500)})),this.showOnlineUserInfo=function(t){lhc.revealModal({url:WWW_DIR_JAVASCRIPT+\"chat/getonlineuserinfo/\"+t})},this.previewChat=function(t){t.chat_id>0&&1==t.can_view_chat&&lhc.revealModal({url:WWW_DIR_JAVASCRIPT+\"chat/previewchat/\"+t.chat_id})},this.sendMessage=function(t){lhc.revealModal({url:WWW_DIR_JAVASCRIPT+\"chat/sendnotice/\"+t})},this.deleteUser=function(t,e){confirm(e)&&a.deleteOnlineUser({user_id:t.id}).then((function(e){c.onlineusers.splice(c.onlineusers.indexOf(t),1)}))},this.disableNewUserBNotif=function(){c.notificationEnabled=!c.notificationEnabled,lhinst.changeUserSettings(\"new_user_bn\",1==c.notificationEnabled?1:0)},this.showConnected=function(){c.online_connected=!c.online_connected,lhinst.changeUserSettings(\"online_connected\",1==c.online_connected?1:0)},this.disableNewUserSound=function(){c.soundEnabled=!c.soundEnabled,lhinst.changeUserSettings(\"new_user_sound\",1==c.soundEnabled?1:0)},this.initController=function(){s.onlineAttributeFilter&&(this.attrf_key_1=s.onlineAttributeFilter.attrf_key_1,this.attrf_val_1=s.onlineAttributeFilter.attrf_val_1,this.attrf_key_2=s.onlineAttributeFilter.attrf_key_2,this.attrf_val_2=s.onlineAttributeFilter.attrf_val_2,this.attrf_key_3=s.onlineAttributeFilter.attrf_key_3,this.attrf_val_3=s.onlineAttributeFilter.attrf_val_3,this.attrf_key_4=s.onlineAttributeFilter.attrf_key_4,this.attrf_val_4=s.onlineAttributeFilter.attrf_val_4,this.attrf_key_5=s.onlineAttributeFilter.attrf_key_5,this.attrf_val_5=s.onlineAttributeFilter.attrf_val_5)},t.$on(\"$destroy\",(function(){r.cancel(l)}))}]);\n"]}