(window.webpackJsonpLHCVoiceCallAPP=window.webpackJsonpLHCVoiceCallAPP||[]).push([[2],{49:function(t,e,a){"use strict";a.r(e);var n=a(14),c=a.n(n),i=a(1),r=a.n(i),l=a(0),o=a.n(l),s=a(29),u=a.n(s),d=a(50);var f=function(t,e){var a=Object(l.useRef)();Object(l.useEffect)((function(){a.current=t}),[t]),Object(l.useEffect)((function(){if(null!==e){var t=setInterval((function(){a.current()}),e);return function(){return clearInterval(t)}}}),[e])},m=a(47);function v(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function h(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?v(Object(a),!0).forEach((function(e){r()(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}a.n(m).a.createClient({mode:"rtc",codec:"vp8"});function p(t,e){switch(e.type){case"attr":return-1===(n=t.chats.findIndex((function(t){return t.id==e.id})))?t:(t.chats[n]=h({},t.chats[n],{},e.value),t=h({},t));case"attr_remove":return-1===(n=t.chats.findIndex((function(t){return t[e.attr]==e.id})))?t:(t.chats[n]=h({},t.chats[n],{},e.value),t=h({},t));case"update":return h({},t,{},e.value);case"add":return-1===(n=t.chats.findIndex((function(t){return t.id==e.value.id})))?t.chats.unshift(e.value):(t.chats[n].active=!0,t.chats[n].mn=0,t.chats[n].support_chat=!1),h({},t);case"remove":return-1===(n=t.chats.findIndex((function(t){return t.id==e.id})))?t:(t.chats.splice(n,1),h({},t));case"update_chat":return-1===(n=t.chats.findIndex((function(t){return t.id==e.id})))?t:(t.chats[n]=h({},t.chats[n],{},e.value),h({},t));case"msg_received":if(-1===(n=t.chats.findIndex((function(t){return t.id==e.id}))))return t;t.chats[n].msg=e.value.msg;var a=document.getElementById("chat-tab-link-"+e.id);return null!==a&&a.classList.contains("active")?t.chats[n].active=!0:t.chats[n].active=!1,t.chats[n].mn=0==t.chats[n].active?t.chats[n].mn?t.chats[n].mn+e.value.mn:e.value.mn:0,t.chats.splice(0,0,t.chats.splice(n,1)[0]),h({},t);case"refocus":var n;if(-1!==(n=t.chats.findIndex((function(t){return 1==t.active})))){if(e.id==t.chats[n].id)return t;t.chats[n].active=!1}return-1!==(n=t.chats.findIndex((function(t){return t.id==e.id})))&&(t.chats[n].active=!0,t.chats[n].mn=0,t.chats[n].support_chat=!1),h({},t);case"group_offline":return t.group_offline=e.value,h({},t);default:throw new Error("Unknown action!")}}e.default=function(t){var e=Object(l.useReducer)(p,{chats:[],call:{},inCall:!1}),a=c()(e,2),n=a[0],i=a[1],r=Object(l.useRef)(n);Object(l.useEffect)((function(){r.current=n}),[n]);Object(l.useEffect)((function(){return u.a.get(WWW_DIR_JAVASCRIPT+"voicevideo/join/"+t.initParams.id+"/"+t.initParams.hash).then((function(t){i({type:"update",value:{call:t.data}})})),function(){}}),[]),Object(l.useEffect)((function(){return 2===n.call.vi_status&&console.log("joined"),function(){}}),[n.call.vi_status]);var s=Object(d.a)("voice_call"),m=s.t,v=(s.i18n,function(){u.a.get(WWW_DIR_JAVASCRIPT+"voicevideo/join/"+t.initParams.id+"/"+t.initParams.hash+"/(action)/cancel").then((function(t){i({type:"update",value:{call:t.data}})}))});f((function(){u.a.get(WWW_DIR_JAVASCRIPT+"voicevideo/join/"+t.initParams.id+"/"+t.initParams.hash).then((function(t){i({type:"update",value:{call:t.data}})}))}),1==n.call.vi_status?2e3:null);var h=function(e){u.a.post(WWW_DIR_JAVASCRIPT+"voicevideo/join/"+t.initParams.id+"/"+t.initParams.hash+"/(action)/request",{type:e}).then((function(t){i({type:"update",value:{call:t.data}})}))};return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"d-flex flex-row flex-grow-1 pt-2"},o.a.createElement("div",{className:"col bg-light mx-1 align-middle text-center d-flex pl-0 pr-0",title:"UID "+n.uid,id:"local-player"},1==n.call.vi_status&&o.a.createElement("div",{className:"align-self-center mx-auto text-muted font-weight-bold"},"Please wait untill operator let's you join a room")),o.a.createElement("div",{className:"col bg-light mx-1 align-middle text-center d-flex pl-0 pr-0"},o.a.createElement("div",{className:"align-self-center mx-auto text-muted font-weight-bold"},"Operator stream will appear here"))),o.a.createElement("div",{className:"row header-chat desktop-header"},o.a.createElement("div",{className:"btn-toolbar p-2 text-center mx-auto btn-toolbar",role:"toolbar","aria-label":"Toolbar with button groups"},o.a.createElement("div",{className:"p-2 text-center mx-auto btn-group",role:"group"},2==n.call.vi_status&&o.a.createElement("span",{className:"text-muted py-2"},"Visitor has joined a call!"),0==n.call.vi_status&&o.a.createElement("span",{className:"text-muted py-2"},"Pending visitor to join a call!"),1==n.call.vi_status&&o.a.createElement("span",{className:"text-muted py-2"},"Visitor is waiting for someone to let him in!")),o.a.createElement("div",{className:"p-2 text-center mx-auto btn-group",role:"group"},2==n.call.vi_status&&o.a.createElement("button",{className:"btn btn-primary w-100",onClick:function(){return v()}},m("voice_call.leave_room")),1==n.call.vi_status&&o.a.createElement("button",{className:"btn btn-primary w-100",onClick:function(){return v()}},m("voice_call.cancel_join")),0==n.call.vi_status&&o.a.createElement(o.a.Fragment,null,o.a.createElement("button",{className:"btn btn-sm btn-outline-secondary",onClick:function(){return h("audio")}},"Join with audio"),o.a.createElement("button",{className:"btn btn-sm btn-outline-secondary",onClick:function(){return h("audiovideo")}},"Join with audio & video"))))))}}}]);
//# sourceMappingURL=2.3da5905ce71547a772e9.js.map