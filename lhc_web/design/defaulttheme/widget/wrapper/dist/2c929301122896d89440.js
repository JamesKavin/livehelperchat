(window.webpackJsonpLiveHelperChat=window.webpackJsonpLiveHelperChat||[]).push([[0],{8:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.msgSnippetWidget=void 0;var i=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}(),n=(s(3),s(4)),o=s(1);var a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.attributes={},this.hidden=!1,this.widgetOpen=!1,this.invitationOpen=!1,this.nhOpen=!1,this.msop=null,this.msg=null,this.cont=new n.UIConstructorIframe((e||"lhc")+"_msgsnippet_widget_v2",o.helperFunctions.getAbstractStyle({zindex:"2147483639",width:"300px",height:"200px",position:"fixed",display:"none"}),null,"iframe"),this.loadStatus={main:!1,theme:!1,status:!1}}return i(t,[{key:"checkLoadStatus",value:function(){1==this.loadStatus.theme&&1==this.loadStatus.main&&1==this.loadStatus.status&&(this.cont.elmDomDoc.body.style.display="",this.fitContent())}},{key:"renderBody",value:function(){var t=this;if(this.cont.tmpl=this.msg.replace("{dev_type}",!0===this.attributes.isMobile?"lhc-mobile":"lhc-desktop").replace("{msg_body}",this.settings.msg_body).replace("{operator_profile}",this.settings.operator_profile),this.cont.bodyId="msgsnippet",null===this.cont.constructUIIframe("",this.attributes.staticJS.dir))return null;this.cont.elmDomDoc.body.style.display="none",this.cont.elmDom.className+=!0===this.attributes.isMobile?" lhc-mobile":" lhc-desktop",this.cont.attachUserEventListener("click",(function(e){t.attributes.eventEmitter.emitEvent("msgSnippetClicked",[{event:e,sender:"closeButton"}]),t.attributes.eventEmitter.emitEvent("showWidget",[{event:e}])}),"start-chat-btn","msgsnippetstart");var e=this;this.cont.attachUserEventListener("click",(function(s){t.attributes.eventEmitter.emitEvent("msgsnippetClosed",[{sender:"closeButton"}]),s.stopPropagation(),e.hide(!0)}),"close-need-help-btn","msgsnippetclose"),this.cont.insertCssRemoteFile({onload:function(){t.loadStatus.main=!0,t.checkLoadStatus()},crossOrigin:"anonymous",href:this.attributes.staticJS.widget_css},!0),1==this.attributes.isMobile&&this.cont.insertCssRemoteFile({crossOrigin:"anonymous",href:this.attributes.staticJS.widget_mobile_css}),this.attributes.theme>0?this.cont.insertCssRemoteFile({onload:function(){t.loadStatus.theme=!0,t.checkLoadStatus()},id:"lhc-theme-msgsnippet",crossOrigin:"anonymous",href:this.attributes.LHC_API.args.lhc_base_url+"/widgetrestapi/theme/"+this.attributes.theme+"?v="+this.attributes.theme_v},!0):(this.loadStatus.theme=!0,this.checkLoadStatus()),this.attributes.sload.subscribe((function(e){e&&(t.loadStatus.status=!0,t.checkLoadStatus())})),this.attributes.eventEmitter.emitEvent("showMsgSnippet",[{sender:"closeButton"}]),this.attributes.eventEmitter.addListener("unread_message",(function(e){e.msop&&(e.msop==t.msop&&e.msg_body?t.showSnippet(e,!0):(t.msop=e.msop,o.helperFunctions.makeRequest(t.attributes.LHC_API.args.lhc_base_url+t.attributes.lang+"widgetrestapi/getmessagesnippet",{params:t.attributes.userSession.getSessionAttributes()},(function(e){t.msop=e.msop,t.msg=e.msg,t.showSnippet(e,!0)}))))})),this.attributes.eventEmitter.addListener("hide_msg_snippet",(function(){t.hide(!0)})),this.attributes.widgetStatus.subscribe((function(e){1==e?(t.widgetOpen=!0,t.hide(!0)):(t.widgetOpen=!1,t.show())})),this.attributes.eventEmitter.addListener("reloadWidget",(function(){t.cont.insertCssRemoteFile({onload:function(){t.loadStatus.theme=!0,t.checkLoadStatus()},id:"lhc-theme-msgsnippet",crossOrigin:"anonymous",href:t.attributes.LHC_API.args.lhc_base_url+"/widgetrestapi/theme/"+t.attributes.theme+"?v="+Date.now()},!0)}))}},{key:"init",value:function(t,e){var s=this;this.attributes=t,this.settings=e,this.settings.msg&&(this.msg=this.settings.msg),this.settings.msop&&(this.msop=this.settings.msop),!this.msg||this.settings.msop&&this.msop!==this.settings.msop?o.helperFunctions.makeRequest(this.attributes.LHC_API.args.lhc_base_url+this.attributes.lang+"widgetrestapi/getmessagesnippet",{params:this.attributes.userSession.getSessionAttributes()},(function(t){s.msop=t.msop,s.msg=t.msg,s.settings.operator_profile=t.operator_profile,s.renderBody()})):this.renderBody()}},{key:"hide",value:function(t){void 0!==t&&!0===t&&(this.hidden=!0),this.cont.hide(),1==this.nhOpen&&this.attributes.eventEmitter.emitEvent("msgSnippetHide",[]),this.attributes.msgsnippet_status.next(!1),this.nhOpen=!1}},{key:"showSnippet",value:function(t,e){1==e&&(this.hidden=!1,this.show()),this.cont.elmDomDoc.getElementById("messages-scroll").innerHTML=t.msg_body,t.operator_profile&&(this.cont.elmDomDoc.getElementById("operator-profile-snippet").innerHTML=t.operator_profile),this.fitContent()}},{key:"fitContent",value:function(){var t=this.cont.elmDomDoc.getElementById("messages-scroll").offsetHeight,e={bottom:70+this.attributes.widgetDimesions.value.wbottom-(91-t)+"px",right:65+this.attributes.widgetDimesions.value.wright+"px"};"bottom_left"==this.attributes.position_placement||"full_height_left"==this.attributes.position_placement?e={bottom:70+this.attributes.widgetDimesions.value.wbottom-(91-t)+"px",left:65+this.attributes.widgetDimesions.value.wright+"px"}:"middle_left"==this.attributes.position_placement?e={bottom:"calc(50% + 35px)",left:65+this.attributes.widgetDimesions.value.wright+"px"}:"middle_right"==this.attributes.position_placement&&(e={bottom:"calc(50% + 35px)",right:65+this.attributes.widgetDimesions.value.wright+"px"}),this.cont.massRestyle(e)}},{key:"show",value:function(){1!=this.hidden&&1!=this.widgetOpen&&1!=this.invitationOpen&&0!=this.attributes.onlineStatus.value&&(!1===this.attributes.hideOffline?(this.cont.show(),0==this.nhOpen&&(this.attributes.eventEmitter.emitEvent("msgSnippetShow",[]),this.attributes.msgsnippet_status.next(!0)),this.nhOpen=!0):(this.cont.hide(),1==this.nhOpen&&(this.attributes.eventEmitter.emitEvent("msgSnippetHide",[]),this.attributes.msgsnippet_status.next(!1)),this.nhOpen=!1))}}]),t}();e.msgSnippetWidget=a}}]);
//# sourceMappingURL=2c929301122896d89440.js.map