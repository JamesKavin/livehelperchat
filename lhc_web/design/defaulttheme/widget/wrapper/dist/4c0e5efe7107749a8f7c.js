(window.webpackJsonpLiveHelperChat=window.webpackJsonpLiveHelperChat||[]).push([[6],{33:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.nodeJSChat=void 0;var s=function(){function e(e,n){for(var t=0;t<n.length;t++){var s=n[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(n,t,s){return t&&e(n.prototype,t),s&&e(n,s),n}}(),a=t(1);var i=new(function(){function e(){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this.params={},this.attributes=null,this.chatEvents=null}return s(e,[{key:"setParams",value:function(e,n,s){this.params=e,this.attributes=n,this.chatEvents=s;var i=this.attributes.userSession.getVID(),o={hostname:e.hostname,path:e.path,authTokenName:"socketCluster.authToken_vi"};""!=e.port&&(o.port=parseInt(e.port)),1==e.secure&&(o.secure=!0);var r=t(43).connect(o);function c(){var e=r.subscribe("uo_"+i);e.on("subscribeFail",(function(e){console.error("Failed to subscribe to the sample channel due to error: "+e)})),e.watch((function(e){"check_message"==e.op?n.eventEmitter.emitEvent("checkMessageOperator"):"is_online"==e.op&&r.publish("ous_"+h,{op:"vi_online",status:!0,vid:i})}))}r.on("error",(function(e){console.error(e)}));var u="uo_"+i,h=this.attributes.instance_id;r.on("deauthenticate",(function(){a.helperFunctions.makeRequest(n.LHC_API.args.lhc_base_url+n.lang+"nodejshelper/tokenvisitor",{params:{ts:(new Date).getTime()}},(function(e){h=e.instance_id,r.emit("login",{hash:e.hash,chanelName:u,instance_id:e.instance_id},(function(e){e&&console.log(e)}))}))})),r.on("connect",(function(e){e.isAuthenticated?(c(),n.LHC_API.args.check_messages=!1):a.helperFunctions.makeRequest(n.LHC_API.args.lhc_base_url+n.lang+"nodejshelper/tokenvisitor",{params:{ts:(new Date).getTime()}},(function(e){h=e.instance_id,r.emit("login",{hash:e.hash,chanelName:u,instance_id:e.instance_id},(function(e){e?console.log(e):(c(),n.LHC_API.args.check_messages=!1)}))}))}))}}]),e}());n.nodeJSChat=i}}]);
//# sourceMappingURL=4c0e5efe7107749a8f7c.js.map