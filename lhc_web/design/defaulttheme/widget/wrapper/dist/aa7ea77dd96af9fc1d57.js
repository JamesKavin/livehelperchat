(window.webpackJsonpLiveHelperChat=window.webpackJsonpLiveHelperChat||[]).push([[5],{29:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.screenShare=void 0;var r=function(){function e(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,s,r){return s&&e(t.prototype,s),r&&e(t,r),t}}(),n=s(1);var a=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.params={},this.attributes=null,this.chatEvents=null,this.isSharing=!1,this.sharemode="chat",this.sharehash=null,this.cobrowser=null,this.intervalRequest=null}return r(e,[{key:"startCoBrowse",value:function(e){var t=this;if(void 0===s)var s=!1;this.isSharing=!0,this.cobrowser=new LHCCoBrowser({formsenabled:s,chat_hash:this.sharehash,nodejssettings:e.nodejssettings,nodejsenabled:e.nodejsenabled,trans:e.trans,url:e.url+"/(hash)/"+this.sharehash+"/?url="+encodeURIComponent(location.href.match(/^(.*\/)[^\/]*$/)[1])}),this.cobrowser.startMirroring();var r=function(e){t.cobrowser&&t.cobrowser.handleMessage(e.split(":"))};this.attributes.eventEmitter.addListener("screenshareCommand",r),this.attributes.eventEmitter.addOnceListener("finishScreenSharing",(function(e){n.helperFunctions.removeById("lhc_status_mirror"),t.attributes.storageHandler.removeSessionStorage("LHC_screenshare"),t.isSharing=!1;var s=document.getElementsByTagName("head")[0],a=document.createElement("script");encodeURIComponent(window.location.href.substring(window.location.protocol.length));a.setAttribute("id","lhc_finish_shr"),a.setAttribute("type","text/javascript"),a.setAttribute("src",LHC_API.args.lhc_base_url+"/cobrowse/finishsession/(sharemode)/chat/(hash)/"+t.sharehash),s.appendChild(a),t.cobrowser=null,t.attributes.eventEmitter.removeListener("screenshareCommand",r)})),this.attributes.storageHandler.setSessionStorage("LHC_screenshare",1)}},{key:"setParams",value:function(e,t,s){var r=this;this.params=e,this.attributes=t,this.chatEvents=s;var a=this.attributes.userSession.getSessionAttributes();this.sharehash=a.id+"_"+a.hash,0==this.isSharing&&n.helperFunctions.makeRequest(LHC_API.args.lhc_base_url+"/widgetrestapi/screensharesettings",{},(function(e){r.params.auto_start||1==e.auto_share||1==r.attributes.focused&&confirm("Allow operator to see your page content?")?(r.initCoBrowsing(e),console.log("A")):0==r.attributes.focused&&(clearInterval(r.intervalRequest),r.intervalRequest=setInterval((function(){1==r.attributes.focused&&(clearInterval(r.intervalRequest),confirm("Allow operator to see your page content?")&&(console.log("B"),r.initCoBrowsing(e)))}),500))}))}},{key:"initCoBrowsing",value:function(e){var t=this;if("undefined"==typeof TreeMirror){var s=document.getElementsByTagName("head")[0],r=document.createElement("script");r.setAttribute("type","text/javascript"),r.setAttribute("src",e.cobrowser),s.appendChild(r),r.onreadystatechange=r.onload=function(){t.startCoBrowse(e)}}else this.startCoBrowse(e)}}]),e}());t.screenShare=a}}]);
//# sourceMappingURL=aa7ea77dd96af9fc1d57.js.map